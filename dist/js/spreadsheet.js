!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Spreadsheet=e():t.Spreadsheet=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function i(t){if(Array.isArray(t))return t}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function r(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){return i(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,l=[],a=!0,o=!1;try{for(i=i.call(t);!(a=(n=i.next()).done)&&(l.push(n.value),!e||l.length!==e);a=!0);}catch(t){o=!0,r=t}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}return l}}(t,e)||r(t,e)||l()}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,i){return e&&c(t.prototype,e),i&&c(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}t.d(e,{default:()=>$n});var h="thtf-spreadsheet";function f(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function d(t){return function(t){if(Array.isArray(t))return n(t)}(t)||f(t)||r(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}window.devicePixelRatio;var v=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return n.forEach((function(i){Object.keys(i).forEach((function(n){var r=i[n];"string"==typeof r||"number"==typeof r||"boolean"==typeof r?e[n]=r:"function"!=typeof r&&!Array.isArray(r)&&r instanceof Object?(e[n]=e[n]||{},t(e[n],r)):e[n]=r}))})),e};function p(t){for(var e="".concat(t),i=0,n=!1,r=0;r<e.length;r+=1)!0===n&&(i+=1),"."===e.charAt(r)&&(n=!0);return i}function y(t,e,i){if(Number.isNaN(e)||Number.isNaN(i))return e+t+i;var n=p(e),r=p(i),l=Number(e),a=Number(i),o=0;switch(t){case"-":o=l-a;break;case"+":o=l+a;break;case"*":o=l*a;break;case"/":p(o=l/a)>5&&(o=o.toFixed(2));break;default:o=o.toFixed(Math.max(n,r))}return o}const g=function(t){return JSON.parse(JSON.stringify(t))},m=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return v.apply(void 0,[{}].concat(e))},w=function t(e,i){var n=Object.keys(e);if(n.length!==Object.keys(i).length)return!1;for(var r=0;r<n.length;r+=1){var l=n[r],a=e[l],o=i[l];if(void 0===o)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==o)return!1;if(Array.isArray(a)){if(a.length!==o.length)return!1;for(var s=0;s<a.length;s+=1)if(!t(a[s],o[s]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,o))return!1;return!0}}},k=function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i+=1)if(t[i]!==e[i])return!1;return!0},b=function(t,e,i){for(var n=0,r=t;r<e;r+=1)n+=i(r);return n},x=function(t,e,i,n,r,l){for(var a=i,o=n,s=t;s<e&&!(a>r);s+=1)a+=o=l(s);return[s,a-o,o]};var R=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function C(t){for(var e="",i=t;i>=R.length;)i/=R.length,i-=1,e+=R[parseInt(i,10)%R.length];return e+R[t%R.length]}function E(t){for(var e=0,i=0;i!==t.length;++i)e=26*e+t.charCodeAt(i)-64;return e-1}function S(t){for(var e="",i="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?i+=t.charAt(n):e+=t.charAt(n);return[E(e),parseInt(i,10)-1]}function O(t,e){return"".concat(C(t)).concat(e+1)}function D(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===i)return t;var r=S(t),l=a(r,2),o=l[0],s=l[1];return n(o,s)?O(o+e,s+i):t}var T=function(){function t(e,i,n,r){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;s(this,t),this.sri=e,this.sci=i,this.eri=n,this.eci=r,this.w=l,this.h=a}return u(t,[{key:"set",value:function(t,e,i,n){this.sri=t,this.sci=e,this.eri=i,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];if(1===n.length){var l=S(n[0]),o=a(l,2);e=o[0],t=o[1]}else 2===n.length&&(t=n[0],e=n[1]);var s=this.sri,c=this.sci,u=this.eri,h=this.eci;return s<=t&&t<=u&&c<=e&&e<=h}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},i=this.sri,n=this.sci,r=this.eri,l=this.eci,a=i;a<=r;a+=1)if(e(a))for(var o=n;o<=l;o+=1)t(a,o)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var i=this.sri,n=this.sci,r=this.eri,l=this.eci;return new t(e.sri<i?e.sri:i,e.sci<n?e.sci:n,e.eri>r?e.eri:r,e.eci>l?e.eci:l)}},{key:"difference",value:function(e){var i=[],n=function(e,n,r,l){i.push(new t(e,n,r,l))},r=this.sri,l=this.sci,a=this.eri,o=this.eci,s=e.sri-r,c=e.sci-l,u=a-e.eri,h=o-e.eci;return s>0?(n(r,l,e.sri-1,o),u>0?(n(e.eri+1,l,a,o),c>0&&n(e.sri,l,e.eri,e.sci-1),h>0&&n(e.sri,e.eci+1,e.eri,o)):(c>0&&n(e.sri,l,a,e.sci-1),h>0&&n(e.sri,e.eci+1,a,o))):u>0&&(n(e.eri+1,l,a,o),c>0&&n(r,l,e.eri,e.sci-1),h>0&&n(r,e.eci+1,e.eri,o)),c>0?(n(r,l,a,e.sci-1),h>0?(n(r,e.eri+1,a,o),s>0&&n(r,e.sci,e.sri-1,e.eci),u>0&&n(e.sri+1,e.sci,a,e.eci)):(s>0&&n(r,e.sci,e.sri-1,o),u>0&&n(e.sri+1,e.sci,a,o))):h>0&&(n(a,e.eci+1,a,o),s>0&&n(r,l,e.sri-1,e.eci),u>0&&n(e.eri+1,l,a,e.eci)),i}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,i=this.eri,n=this.eci,r=O(e,t);return this.multiple()&&(r="".concat(r,":").concat(O(n,i))),r}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}],[{key:"valueOf",value:function(e){var i=e.split(":"),n=a(S(i[0]),2),r=n[0],l=n[1],o=l,s=r;if(i.length>1){var c=a(S(i[1]),2);s=c[0],o=c[1]}return new t(l,r,o,s)}}]),t}();const A=T;var z=function(){function t(e){var i=e.len,n=e.height;s(this,t),this._={},this.len=i,this.height=n}return u(t,[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var i=this.getOrNew(t);!0===e?i.hide=!0:delete i.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,i){var n=this;return b(t,e,(function(t){return i&&i.has(t)?0:n.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var i=this.get(t);return void 0!==i&&void 0!==i.cells&&void 0!==i.cells[e]?i.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var i=this.getCell(t,e);return i&&i.merge?i.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var i=this.getOrNew(t);return i.cells[e]=i.cells[e]||{},i.cells[e]}},{key:"setCell",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",r=this.getOrNew(t);"all"===n?r.cells[e]=i:"text"===n?(r.cells[e]=r.cells[e]||{},r.cells[e].text=i.text):"format"===n&&(r.cells[e]=r.cells[e]||{},r.cells[e].style=i.style,i.merge&&(r.cells[e].merge=i.merge))}},{key:"setCellText",value:function(t,e,i){var n=this.getCellOrNew(t,e);!1!==n.editable&&(n.text=i)}},{key:"copyPaste",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},l=t.sri,o=t.sci,s=t.eri,c=t.eci,u=e.sri,h=e.sci,f=e.eri,d=e.eci,v=t.size(),p=a(v,2),y=p[0],m=p[1],w=e.size(),k=a(w,2),b=k[0],x=k[1],R=!0,C=0;(f<l||d<o)&&(R=!1,C=f<l?b:x);for(var E=l;E<=s;E+=1)if(this._[E])for(var S=o;S<=c;S+=1)if(this._[E].cells&&this._[E].cells[S])for(var O=u;O<=f;O+=y)for(var T=h;T<=d;T+=m){var A=O+(E-l),z=T+(S-o),B=g(this._[E].cells[S]);n&&B&&B.text&&B.text.length>0&&function(){var t=B.text,e=T-h+(O-u)+2;if(R||(e-=C+1),"="===t[0])B.text=t.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){var i=0,n=0;return l===u?i=e-1:n=e-1,/^\d+$/.test(t)?t:D(t,i,n)}));else if(y<=1&&m>1&&(u>s||f<l)||m<=1&&y>1&&(h>c||d<o)||y<=1&&m<=1){var i=/[\\.\d]+$/.exec(t);if(null!==i){var n=Number(i[0])+e-1;B.text=t.substring(0,i.index)+n}}}(),this.setCell(A,z,B,i),r(A,z,B)}}},{key:"cutPaste",value:function(t,e){var i=this,n={};this.each((function(r){i.eachCells(r,(function(l){var a=parseInt(r,10),o=parseInt(l,10);t.includes(r,l)&&(a=e.sri+(a-t.sri),o=e.sci+(o-t.sci)),n[a]=n[a]||{cells:{}},n[a].cells[o]=i._[r].cells[l]}))})),this._=n}},{key:"paste",value:function(t,e){var i=this;if(!(t.length<=0)){var n=e.sri,r=e.sci;t.forEach((function(t,e){var l=n+e;t.forEach((function(t,e){var n=r+e;i.setCellText(l,n,t)}))}))}}},{key:"insert",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={};this.each((function(r,l){var a=parseInt(r,10);a>=t&&(a+=i,e.eachCells(r,(function(e,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return D(e,0,i,(function(e,i){return i>=t}))})))}))),n[a]=l})),this._=n,this.len+=i}},{key:"delete",value:function(t,e){var i=this,n=e-t+1,r={};this.each((function(l,a){var o=parseInt(l,10);o<t?r[o]=a:l>e&&(r[o-n]=a,i.eachCells(l,(function(t,i){i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return D(t,0,-n,(function(t,i){return i>e}))})))})))})),this._=r,this.len-=n}},{key:"insertColumn",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(n,r){var l={};e.eachCells(n,(function(e,n){var r=parseInt(e,10);r>=t&&(r+=i,n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return D(e,i,0,(function(e){return e>=t}))})))),l[r]=n})),r.cells=l}))}},{key:"deleteColumn",value:function(t,e){var i=this,n=e-t+1;this.each((function(r,l){var a={};i.eachCells(r,(function(i,r){var l=parseInt(i,10);l<t?a[l]=r:l>e&&(a[l-n]=r,r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return D(t,-n,0,(function(t){return t>e}))}))))})),l.cells=a}))}},{key:"deleteCells",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,n){e.deleteCell(t,n,i)}))}},{key:"deleteCell",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=this.get(t);if(null!==n){var r=this.getCell(t,e);null!==r&&!1!==r.editable&&("all"===i?delete n.cells[e]:"text"===i?(r.text&&delete r.text,r.value&&delete r.value):"format"===i?(void 0!==r.style&&delete r.style,r.merge&&delete r.merge):"merge"===i&&r.merge&&delete r.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],i=this._[e];if(i){var n=i.cells,r=Object.keys(n),l=r[r.length-1];return[parseInt(e,10),parseInt(l,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var i=a(e,2),n=i[0],r=i[1];t(n,r)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var i=a(t,2),n=i[0],r=i[1];e(n,r)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}]),t}(),B=function(){function t(e){var i=e.len,n=e.width,r=e.indexWidth,l=e.minWidth;s(this,t),this._={},this.len=i,this.width=n,this.indexWidth=r,this.minWidth=l}return u(t,[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var i=this.getOrNew(t);!0===e?i.hide=!0:delete i.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var i=this;return b(t,e,(function(t){return i.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}]),t}(),I=function t(){s(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0},P=function(){function t(){s(this,t),this.range=new T(0,0,0,0),this.ri=0,this.ci=0}return u(t,[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}]),t}(),H=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];s(this,t),this._=e}return u(t,[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var i=0;i<this._.length;i+=1){var n=this._[i];if(n.includes(t,e))return n}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,i,n){this._.forEach((function(r){var l=r.sri,a=r.sci,o=r.eri,s=r.eci,c=r;"row"===t?l>=e?(c.sri+=i,c.eri+=i):l<e&&e<=o&&(c.eri+=i,n(l,a,i,0)):"column"===t&&(a>=e?(c.sci+=i,c.eci+=i):a<e&&e<=s&&(c.eci+=i,n(l,a,0,i)))}))}},{key:"move",value:function(t,e,i){this._.forEach((function(n){var r=n;r.within(t)&&(r.eri+=e,r.sri+=e,r.sci+=i,r.eci+=i)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return A.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}]),t}();function F(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var N=["cn","en"],M={cn:{toolbar:{undo:"撤销",redo:"恢复",print:"打印",paintformat:"格式刷",clearformat:"清除格式",format:"数据格式",fontName:"字体",fontSize:"字号",fontBold:"加粗",fontItalic:"倾斜",underline:"下划线",strike:"删除线",color:"字体颜色",bgcolor:"填充颜色",border:"边框",merge:"合并单元格",align:"水平对齐",valign:"垂直对齐",textwrap:"自动换行",freeze:"冻结",autofilter:"自动筛选",formula:"函数",more:"更多"},contextmenu:{copy:"复制",cut:"剪切",paste:"粘贴",pasteValue:"粘贴数据",pasteFormat:"粘贴格式",hide:"隐藏",insertRow:"插入行",insertColumn:"插入列",deleteSheet:"删除",deleteRow:"删除行",deleteColumn:"删除列",deleteCell:"删除",deleteCellText:"删除数据",validation:"数据验证",cellprintable:"可打印",cellnonprintable:"不可打印",celleditable:"可编辑",cellnoneditable:"不可编辑"},print:{size:"纸张大小",orientation:"方向",orientations:["横向","纵向"]},format:{normal:"正常",text:"文本",number:"数值",percent:"百分比",rmb:"人民币",usd:"美元",eur:"欧元",date:"短日期",time:"时间",datetime:"长日期",duration:"持续时间"},formula:{sum:"求和",average:"求平均值",max:"求最大值",min:"求最小值",concat:"字符拼接",_if:"条件判断",and:"和",or:"或"},validation:{required:"此值必填",notMatch:"此值不匹配验证规则",between:"此值应在 {} 和 {} 之间",notBetween:"此值不应在 {} 和 {} 之间",notIn:"此值不在列表中",equal:"此值应该等于 {}",notEqual:"此值不应该等于 {}",lessThan:"此值应该小于 {}",lessThanEqual:"此值应该小于等于 {}",greaterThan:"此值应该大于 {}",greaterThanEqual:"此值应该大于等于 {}"},error:{pasteForMergedCell:"无法对合并的单元格执行此操作"},calendar:{weeks:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},button:{next:"下一步",cancel:"取消",remove:"删除",save:"保存",ok:"确认"},sort:{desc:"降序",asc:"升序"},filter:{empty:"空白"},dataValidation:{mode:"模式",range:"单元区间",criteria:"条件",modeType:{cell:"单元格",column:"列模式",row:"行模式"},type:{list:"列表",number:"数字",date:"日期",phone:"手机号",email:"电子邮件"},operator:{be:"在区间",nbe:"不在区间",lt:"小于",lte:"小于等于",gt:"大于",gte:"大于等于",eq:"等于",neq:"不等于"}}},en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not between",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function W(t,e){if(e){var i,n=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return F(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?F(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,o=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){o=!0,l=t},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw l}}}}(N);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(!e[r])break;for(var l=e[r],a=t.match(/(?:\\.|[^.])+/g),o=0;o<a.length;o+=1){var s=l[a[o]];if(!s)break;if(o===a.length-1)return s;l=s}}}catch(t){n.e(t)}finally{n.f()}}}function j(t){var e=W(t,M);return!e&&window&&window.Spreadsheet&&window.Spreadsheet.$message&&(e=W(t,window.Spreadsheet.$message)),e||""}function _(t){return function(){return j(t)}}var V={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function q(t,e){var i="";if(!t){for(var n=arguments.length,r=new Array(n>2?n-2:0),l=2;l<n;l++)r[l-2]=arguments[l];i=j.apply(void 0,["validation.".concat(e)].concat(r))}return[t,i]}var L=function(){function t(e,i,n,r){s(this,t),this.required=i,this.value=n,this.type=e,this.operator=r,this.message=""}return u(t,[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?k(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,i=this.operator,n=this.value,r=this.type;if(e&&/^\s*$/.test(t))return q(!1,"required");if(/^\s*$/.test(t))return[!0];if(V[r]&&!V[r].test(t))return q(!1,"notMatch");if("list"===r)return q(this.values().includes(t),"notIn");if(i){var l=this.parseValue(t);if("be"===i){var o=a(n,2),s=o[0],c=o[1];return q(l>=this.parseValue(s)&&l<=this.parseValue(c),"between",s,c)}if("nbe"===i){var u=a(n,2),h=u[0],f=u[1];return q(l<this.parseValue(h)||l>this.parseValue(f),"notBetween",h,f)}if("eq"===i)return q(l===this.parseValue(n),"equal",n);if("neq"===i)return q(l!==this.parseValue(n),"notEqual",n);if("lt"===i)return q(l<this.parseValue(n),"lessThan",n);if("lte"===i)return q(l<=this.parseValue(n),"lessThanEqual",n);if("gt"===i)return q(l>this.parseValue(n),"greaterThan",n);if("gte"===i)return q(l>=this.parseValue(n),"greaterThanEqual",n)}return[!0]}}]),t}(),Q=function(){function t(e,i,n){s(this,t),this.refs=i,this.mode=e,this.validator=n}return u(t,[{key:"includes",value:function(t,e){for(var i=this.refs,n=0;n<i.length;n+=1)if(T.valueOf(i[n]).includes(t,e))return!0;return!1}},{key:"addRef",value:function(t){this.remove(T.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach((function(i){var n=T.valueOf(i);n.intersects(t)?n.difference(t).forEach((function(t){return e.push(t.toString())})):e.push(i)})),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,i=this.validator;return{refs:t,mode:e,type:i.type,required:i.required,operator:i.operator,value:i.value}}}],[{key:"valueOf",value:function(e){var i=e.refs,n=e.mode,r=e.type,l=e.required,a=e.operator,o=e.value;return new t(n,i,new L(r,l,o,a))}}]),t}(),U=function(){function t(){s(this,t),this._=[],this.errors=new Map}return u(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,i){var n=this.get(t,e),r="".concat(t,"_").concat(e),l=this.errors;if(null!==n){var o=a(n.validator.validate(i),2),s=o[0],c=o[1];s?l.delete(r):l.set(r,c)}else l.delete(r);return!0}},{key:"add",value:function(t,e,i){var n=i.type,r=i.required,l=i.value,a=i.operator,o=new L(n,r,l,a),s=this.getByValidator(o);null!==s?s.addRef(e):this._.push(new Q(t,[e],o))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var i=this._[e];if(i.validator.equals(t))return i}return null}},{key:"get",value:function(t,e){for(var i=0;i<this._.length;i+=1){var n=this._[i];if(n.includes(t,e))return n}return null}},{key:"remove",value:function(t){this.each((function(e){e.remove(t)}))}},{key:"each",value:function(t){this._.forEach((function(e){return t(e)}))}},{key:"getData",value:function(){return this._.filter((function(t){return t.refs.length>0})).map((function(t){return t.getData()}))}},{key:"setData",value:function(t){this._=t.map((function(t){return Q.valueOf(t)}))}}]),t}(),Y=function(){function t(e,i,n){s(this,t),this.ci=e,this.operator=i,this.value=n}return u(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,i=this.value;return"all"===e||"in"===e&&i.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),t}(),X=function(){function t(e,i){s(this,t),this.ci=e,this.order=i}return u(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),$=function(){function t(){s(this,t),this.ref=null,this.filters=[],this.sort=null}return u(t,[{key:"setData",value:function(t){var e=t.ref,i=t.filters,n=t.sort;null!=e&&(this.ref=e,this.filters=i.map((function(t){return new Y(t.ci,t.operator,t.value)})),n&&(this.sort=new X(n.ci,n.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,i=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:i}}return{}}},{key:"addFilter",value:function(t,e,i){var n=this.getFilter(t);null==n?this.filters.push(new Y(t,e,i)):n.set(e,i)}},{key:"setSort",value:function(t,e){this.sort=e?new X(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,i=0;i<e.length;i+=1)if(e[i].ci===t)return e[i];return null}},{key:"filteredRows",value:function(t){var e=new Set,i=new Set;if(this.active())for(var n=this.range(),r=n.sri,l=n.eri,a=this.filters,o=r+1;o<=l;o+=1)for(var s=0;s<a.length;s+=1){var c=a[s],u=t(o,c.ci),h=u?u.text:"";if(!c.includes(h)){e.add(o);break}i.add(o)}return{rset:e,fset:i}}},{key:"items",value:function(t,e){var i={};if(this.active())for(var n=this.range(),r=n.sri,l=n.eri,a=r+1;a<=l;a+=1){var o=e(a,t);if(null===o||/^\s*$/.test(o.text))i[""]=(i[""]||0)+1;else{var s=o.text,c=(i[s]||0)+1;i[s]=c}}return i}},{key:"range",value:function(){return T.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}();const K=function(){function t(){s(this,t),this.range=null,this.state="clear"}return u(t,[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}]),t}(),J=function(){function t(){s(this,t),this.undoItems=[],this.redoItems=[]}return u(t,[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var i=this.undoItems,n=this.redoItems;this.canUndo()&&(n.push(JSON.stringify(t)),e(JSON.parse(i.pop())))}},{key:"redo",value:function(t,e){var i=this.undoItems,n=this.redoItems;this.canRedo()&&(i.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}}]),t}();var Z={mode:"edit",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function G(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=this.merges,r=e.clone(),l=t.size(),o=a(l,2),s=o[0],c=o[1],u=e.size(),h=a(u,2),f=h[0],d=h[1];return s>f&&(r.eri=e.sri+s-1),c>d&&(r.eci=e.sci+c-1),!n.intersects(r)||(i(j("error.pasteForMergedCell")),!1)}function tt(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.rows,l=this.merges;"all"!==i&&"format"!==i||(r.deleteCells(e,i),l.deleteWithin(e)),r.copyPaste(t,e,i,n,(function(t,e,i){if(i&&i.merge){var n=a(i.merge,2),r=n[0],o=n[1];if(r<=0&&o<=0)return;l.add(new T(t,e,t+r,e+o))}}))}function et(t,e){var i=this.clipboard,n=this.rows,r=this.merges;n.cutPaste(t,e),r.move(t,e.sri-t.sri,e.sci-t),i.clear()}function it(t,e,i){var n=this.styles,r=this.rows.getCellOrNew(t,e),l={};void 0!==r.style&&(l=g(n[r.style])),l=m(l,{border:i}),r.style=this.addStyle(l)}function nt(t){var e=this,i=t.mode,n=t.style,r=t.color,l=this.styles,o=this.selector,s=this.rows,c=o.range,u=c.sri,h=c.sci,f=c.eri,d=c.eci,v=!this.isSingleSelected();if(v||"inside"!==i&&"horizontal"!==i&&"vertical"!==i)if("outside"!==i||v){if("none"===i)o.range.each((function(t,i){var n=s.getCell(t,i);if(n&&void 0!==n.style){var r=g(l[n.style]);delete r.border,n.style=e.addStyle(r)}}));else if("all"===i||"inside"===i||"outside"===i||"horizontal"===i||"vertical"===i)!function(){for(var t=[],l=u;l<=f;l+=1)for(var o=h;o<=d;o+=1){for(var c=[],p=0;p<t.length;p+=1){var y=a(t[p],4),g=y[0],m=y[1],w=y[2],k=y[3];if(l===g+w+1&&c.push(p),g<=l&&l<=g+w&&o===m){o+=k+1;break}}if(c.forEach((function(e){return t.splice(e,1)})),o>d)break;var b=s.getCell(l,o),x=0,R=0;if(b&&b.merge){var C=a(b.merge,2);x=C[0],R=C[1],t.push([l,o,x,R])}var E=x>0&&l+x===f,S=R>0&&o+R===d,O={};"all"===i?O={bottom:[n,r],top:[n,r],left:[n,r],right:[n,r]}:"inside"===i?(!S&&o<d&&(O.right=[n,r]),!E&&l<f&&(O.bottom=[n,r])):"horizontal"===i?!E&&l<f&&(O.bottom=[n,r]):"vertical"===i?!S&&o<d&&(O.right=[n,r]):"outside"===i&&v&&(u===l&&(O.top=[n,r]),(E||f===l)&&(O.bottom=[n,r]),h===o&&(O.left=[n,r]),(S||d===o)&&(O.right=[n,r])),Object.keys(O).length>0&&it.call(e,l,o,O),o+=R}}();else if("top"===i||"bottom"===i)for(var p=h;p<=d;p+=1)"top"===i&&(it.call(this,u,p,{top:[n,r]}),p+=s.getCellMerge(u,p)[1]),"bottom"===i&&(it.call(this,f,p,{bottom:[n,r]}),p+=s.getCellMerge(f,p)[1]);else if("left"===i||"right"===i)for(var y=u;y<=f;y+=1)"left"===i&&(it.call(this,y,h,{left:[n,r]}),y+=s.getCellMerge(y,h)[0]),"right"===i&&(it.call(this,y,d,{right:[n,r]}),y+=s.getCellMerge(y,d)[0])}else it.call(this,u,h,{top:[n,r],bottom:[n,r],left:[n,r],right:[n,r]})}function rt(t,e){var i=this.rows,n=this.freezeTotalHeight(),r=i.height;n+i.height<t&&(r-=e);for(var l=this.exceptRowSet,a=0,o=r,s=i.height;a<i.len&&!(o>t);a+=1)l.has(a)||(o+=s=i.getHeight(a));return(o-=s)<=0?{ri:-1,top:0,height:s}:{ri:a-1,top:o,height:s}}function lt(t,e){var i=this.cols,n=this.freezeTotalWidth(),r=i.indexWidth;n+i.indexWidth<t&&(r-=e);var l=a(x(0,i.len,r,i.indexWidth,t,(function(t){return i.getWidth(t)})),3),o=l[0],s=l[1],c=l[2];return s<=0?{ci:-1,left:0,width:i.indexWidth}:{ci:o-1,left:s,width:c}}var at=function(){function t(e,i){s(this,t),this.settings=m(Z,i||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new H,this.rows=new z(this.settings.row),this.cols=new B(this.settings.col),this.validations=new U,this.hyperlinks={},this.comments={},this.selector=new P,this.scroll=new I,this.history=new J,this.clipboard=new K,this.autoFilter=new $,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}return u(t,[{key:"addValidation",value:function(t,e,i){var n=this;this.changeData((function(){n.validations.add(t,e,i)}))}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData((function(){t.validations.remove(e)}))}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,i=t.ci,n=this.validations.get(e,i);return n?n.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,i=t.ci,n=t.range,r=this.validations.get(e,i),l={ref:n.toString()};return null!==r&&(l.mode=r.mode,l.validator=r.validator),l}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(t){for(var e=[],i=this.selector.range,n=i.sri,r=i.eri,l=i.sci,a=i.eci,o=n;o<=r;o+=1){for(var s=[],c=l;c<=a;c+=1){var u=this.getCell(o,c);s.push(u&&u.text||"")}e.push(s)}e=e.map((function(t){return t.join("\t")})).join("\n"),t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(e).then((function(){}),(function(t){console.error("text copy to the system clipboard error  ",e,t)}))}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.clipboard,r=this.selector;return!n.isClear()&&!!G.call(this,n.range,r.range,i)&&(this.changeData((function(){n.isCopy()?tt.call(t,n.range,r.range,e):n.isCut()&&et.call(t,n.range,r.range)})),!0)}},{key:"pasteFromText",value:function(t){var e;if((e=/\r\n/.test(t)?t.split("\r\n").map((function(t){return t.replace(/"/g,"").split("\t")})):t.split("\n").map((function(t){return t.replace(/"/g,"").split("\t")}))).length){var i=this.rows,n=this.selector;this.changeData((function(){i.paste(e,n.range)}))}}},{key:"autofill",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.selector.range;return!!G.call(this,r,t,n)&&(this.changeData((function(){tt.call(i,r,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var i=this.selector,n=this.rows,r=this.cols,l=this.merges,a=i.range,o=a.sri,s=a.sci,c=a.eri,u=a.eci,h=i.ri,f=i.ci,d=t,v=e;return t<0&&(d=n.len-1),e<0&&(v=r.len-1),d>h?(o=h,c=d):(o=d,c=h),v>f?(s=f,u=v):(s=v,u=f),i.range=l.union(new T(o,s,c,u)),i.range=l.union(i.range),i.range}},{key:"calSelectedRangeByStart",value:function(t,e){var i=this.selector,n=this.rows,r=this.cols,l=this.merges.getFirstIncludes(t,e);return null===l&&(l=new T(t,e,t,e),-1===t&&(l.sri=0,l.eri=n.len-1),-1===e&&(l.sci=0,l.eci=r.len-1)),i.range=l,l}},{key:"setSelectedCellAttr",value:function(t,e){var i=this;this.changeData((function(){var n=i.selector,r=i.styles,l=i.rows;if("merge"===t)e?i.merge():i.unmerge();else if("border"===t)nt.call(i,e);else if("formula"===t){var o=n.ri,s=n.ci,c=n.range;if(n.multiple()){var u=a(n.size(),2),h=u[0],f=u[1],d=c.sri,v=c.sci,p=c.eri,y=c.eci;if(h>1)for(var m=v;m<=y;m+=1)l.getCellOrNew(p+1,m).text="=".concat(e,"(").concat(O(m,d),":").concat(O(m,p),")");else f>1&&(l.getCellOrNew(o,y+1).text="=".concat(e,"(").concat(O(v,o),":").concat(O(y,o),")"))}else l.getCellOrNew(o,s).text="=".concat(e,"()")}else n.range.each((function(n,a){var o=l.getCellOrNew(n,a),s={};if(void 0!==o.style&&(s=g(r[o.style])),"format"===t)s.format=e,o.style=i.addStyle(s);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var c={};c[t.split("-")[1]]=e,s.font=Object.assign(s.font||{},c),o.style=i.addStyle(s)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(s[t]=e,o.style=i.addStyle(s)):o[t]=e}))}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",i=this.autoFilter,n=this.selector,r=this.rows,l=n.ri,a=n.ci,o=l;this.unsortedRowMap.has(l)&&(o=this.unsortedRowMap.get(l));var s=r.getCell(o,a),c=s?s.text:"";if(this.setCellText(o,a,t,e),i.active()){var u=i.getFilter(a);if(u){var h=u.value.findIndex((function(t){return t===c}));h>=0&&u.value.splice(h,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,i=t.ci,n=e;return this.unsortedRowMap.has(e)&&(n=this.unsortedRowMap.get(e)),this.rows.getCell(n,i)}},{key:"xyInSelectedRect",value:function(t,e){var i=this.getSelectedRect(),n=i.left,r=i.top,l=i.width,a=i.height,o=t-this.cols.indexWidth,s=e-this.rows.height;return o>n&&o<n+l&&s>r&&s<r+a}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,i=this.rows,n=this.cols,r=this.exceptRowSet,l=t.sri,a=t.sci,o=t.eri,s=t.eci;if(l<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var c=n.sumWidth(0,a),u=i.sumHeight(0,l,r),h=i.sumHeight(l,o+1,r),f=n.sumWidth(a,s+1),d=c-e.x,v=u-e.y,p=this.freezeTotalHeight(),y=this.freezeTotalWidth();return y>0&&y>c&&(d=c),p>0&&p>u&&(v=u),{l:c,t:u,left:d,top:v,height:h,width:f,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var i=this.scroll,n=this.merges,r=this.rows,l=this.cols,a=rt.call(this,e,i.y),o=a.ri,s=a.top,c=a.height,u=lt.call(this,t,i.x),h=u.ci,f=u.left,d=u.width;if(-1===h&&(d=l.totalWidth()),-1===o&&(c=r.totalHeight()),o>=0||h>=0){var v=n.getFirstIncludes(o,h);if(v){o=v.sri,h=v.sci;var p=this.cellRect(o,h);f=p.left,s=p.top,d=p.width,c=p.height}}return{ri:o,ci:h,left:f,top:s,width:d,height:c}}},{key:"isSingleSelected",value:function(){var t=this.selector.range,e=t.sri,i=t.sci,n=t.eri,r=t.eci,l=this.getCell(e,i);if(l&&l.merge){var o=a(l.merge,2),s=o[0],c=o[1];if(e+s===n&&i+c===r)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,i=t.sci,n=t.eri,r=t.eci,l=this.getCell(e,i);if(l&&l.merge){var o=a(l.merge,2),s=o[0],c=o[1];if(e+s===n&&i+c===r)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,i=this.rows;if(!this.isSingleSelected()){var n=a(e.size(),2),r=n[0],l=n[1];if(r>1||l>1){var o=e.range,s=o.sri,c=o.sci;this.changeData((function(){var n=i.getCellOrNew(s,c);n.merge=[r-1,l-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(s,c,n)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSingleSelected()){var i=e.range,n=i.sri,r=i.sci;this.changeData((function(){t.rows.deleteCell(n,r,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutoFilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,i=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=i.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,i,n){var r=this.autoFilter;r.addFilter(t,i,n),r.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,i=this.rows;if(e.active()){var n=e.sort,r=e.filteredRows((function(t,e){return i.getCell(t,e)})),l=r.rset,a=r.fset,o=Array.from(a),s=Array.from(a);n&&o.sort((function(t,e){return"asc"===n.order?t-e:"desc"===n.order?e-t:0})),this.exceptRowSet=l,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,o.forEach((function(e,i){t.sortedRowMap.set(s[i],e),t.unsortedRowMap.set(e,s[i])}))}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",i=this.selector;this.changeData((function(){t.rows.deleteCells(i.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(i.range)}))}},{key:"insert",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var n=e.selector.range,r=n.sri,l=n.sci,a=e.rows,o=e.merges,s=e.cols,c=r;"row"===t?a.insert(r,i):"column"===t&&(a.insertColumn(l,i),c=l,s.len+=1),o.shift(t,c,i,(function(t,e,i,n){var r=a.getCell(t,e);r.merge[0]+=i,r.merge[1]+=n}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var i=e.rows,n=e.merges,r=e.selector,l=e.cols,o=r.range,s=r.range,c=s.sri,u=s.sci,h=s.eri,f=s.eci,d=a(r.range.size(),2),v=d[0],p=d[1],y=c,g=v;"row"===t?i.delete(c,h):"column"===t&&(i.deleteColumn(u,f),y=o.sci,g=p,l.len-=f-u+1),n.shift(t,y,-g,(function(t,e,n,r){var l=i.getCell(t,e);l.merge[0]+=n,l.merge[1]+=r,0===l.merge[0]&&0===l.merge[1]&&delete l.merge}))}))}},{key:"scrollx",value:function(t,e){var i=this.scroll,n=this.freeze,r=this.cols,l=a(n,2)[1],o=a(x(l,r.len,0,0,t,(function(t){return r.getWidth(t)})),3),s=o[0],c=o[1],u=o[2],h=c;t>0&&(h+=u),i.x!==h&&(i.ci=t>0?s:0,i.x=h,e())}},{key:"scrolly",value:function(t,e){var i=this.scroll,n=this.freeze,r=this.rows,l=a(n,1)[0],o=a(x(l,r.len,0,0,t,(function(t){return r.getHeight(t)})),3),s=o[0],c=o[1],u=o[2],h=c;t>0&&(h+=u),i.y!==h&&(i.ri=t>0?s:0,i.y=h,e())}},{key:"cellRect",value:function(t,e){var i=this.rows,n=this.cols,r=n.sumWidth(0,e),l=i.sumHeight(0,t),o=i.getCell(t,e),s=n.getWidth(e),c=i.getHeight(t);if(null!==o&&o.merge){var u=a(o.merge,2),h=u[0],f=u[1];if(h>0)for(var d=1;d<=h;d+=1)c+=i.getHeight(t+d);if(f>0)for(var v=1;v<=f;v+=1)s+=n.getWidth(e+v)}return{left:r,top:l,width:s,height:c,cell:o}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var i=this.getCell(t,e);return i&&i.text?i.text:""}},{key:"getCellStyle",value:function(t,e){var i=this.getCell(t,e);return i&&void 0!==i.style?this.styles[i.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var i=this.styles,n=this.rows.getCell(t,e),r=n&&void 0!==n.style?i[n.style]:{};return m(this.defaultStyle(),r)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,i=t.ci;return this.getCellStyleOrDefault(e,i)}},{key:"setCellText",value:function(t,e,i,n){var r=this.rows,l=this.history,a=this.validations;"finished"===n?(r.setCellText(t,e,""),l.add(this.getData()),r.setCellText(t,e,i)):(r.setCellText(t,e,i),this.change(this.getData())),a.validate(t,e,i)}},{key:"freezeIsActive",value:function(){var t=a(this.freeze,2),e=t[0],i=t[1];return e>0||i>0}},{key:"setFreeze",value:function(t,e){var i=this;this.changeData((function(){i.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var i=this;this.changeData((function(){i.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var i=this;this.changeData((function(){i.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,i=t.showToolbar,n=t.showBottomBar,r=e.height();return n&&(r-=41),i&&(r-=41),r}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=a(this.freeze,2),e=t[0],i=t[1];return new T(0,0,e-1,i-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,i=a(t.maxCell(),2),n=i[0],r=i[1],l=t.sumHeight(0,n+1),o=e.sumWidth(0,r+1);return new T(0,0,n,r,o,l)}},{key:"exceptRowTotalHeight",value:function(t,e){var i=this.exceptRowSet,n=this.rows,r=Array.from(i),l=0;return r.forEach((function(i){if(i<t||i>e){var r=n.getHeight(i);l+=r}})),l}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,i=this.cols,n=this.freeze,r=this.exceptRowSet,l=t.ri,o=t.ci;l<=0&&(l=a(n,1)[0]),o<=0&&(o=a(n,2)[1]);for(var s=0,c=0,u=[e.len,i.len],h=u[0],f=u[1],d=l;d<e.len&&(r.has(d)||(c+=e.getHeight(d),h=d),!(c>this.viewHeight()));d+=1);for(var v=o;v<i.len&&(f=v,!((s+=i.getWidth(v))>this.viewWidth()));v+=1);return new T(l,o,h,f,s,c)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,i=this.selector,n=a(i.size(),2),r=n[0],l=n[1],o=i.range,s=o.sri,c=o.sci,u=o.eri,h=o.eci;if(r===t.len)for(var f=c;f<=h;f+=1)e.setHide(f,!0);else if(l===e.len)for(var d=s;d<=u;d+=1)t.setHide(d,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,i){for(var n=0,r=this.rows,l=this.exceptRowSet,a=d(l),o=0,s=0;s<a.length;s+=1)a[s]<t&&(o+=1);for(var c=t+o;c<=e+o;c+=1)if(l.has(c))o+=1;else{var u=r.getHeight(c);if(u>0&&(i(c,n,u),(n+=u)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,i){for(var n=0,r=this.cols,l=t;l<=e;l+=1){var a=r.getWidth(l);if(a>0&&(i(l,n,a),(n+=a)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,i=0;i<e.length;i+=1){var n=e[i];if(w(n,t))return i}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(i){if("merges"===i||"rows"===i||"cols"===i||"validations"===i)e[i].setData(t[i]);else if("freeze"===i){var n=a(S(t[i]),2),r=n[0],l=n[1];e.freeze=[l,r]}else"autofilter"===i?e.autoFilter.setData(t[i]):void 0!==t[i]&&(e[i]=t[i])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,i=this.styles,n=this.merges,r=this.rows,l=this.cols,a=this.validations,o=this.autoFilter;return{name:t,freeze:O(e[1],e[0]),styles:i,merges:n.getData(),rows:r.getData(),cols:l.getData(),validations:a.getData(),autofilter:o.getData()}}}]),t}();function ot(t){return i(t)||f(t)||r(t)||l()}var st=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";s(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=i):this.el=e,this.data={}}return u(t,[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var i=ot(t.split(".")),n=i[0],r=i.slice(1),l=n;return"mousewheel"===l&&/Firefox/i.test(window.navigator.userAgent)&&(l="DOMMouseScroll"),this.el.addEventListener(l,(function(t){e(t);for(var i=0;i<r.length;i+=1){var n=r[i];if("left"===n&&0!==t.button)return;if("right"===n&&2!==t.button)return;"stop"===n&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(i){e.css(i,"".concat(t[i],"px"))})),this;var i=this.el;return{top:i.offsetTop,left:i.offsetLeft,height:i.offsetHeight,width:i.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(i.forEach((function(e){return t.child(e)})),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var i=e;return"string"==typeof e?i=document.createTextNode(e):e instanceof t&&(i=e.el),this.el.appendChild(i),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var i=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){i.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var i=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){i.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}]),t}(),ct=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new st(t,e)},ut=[{key:"SUM",title:_("formula.sum"),render:function(t){return t.reduce((function(t,e){return y("+",t,e)}),0)}},{key:"AVERAGE",title:_("formula.average"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)/t.length}},{key:"MAX",title:_("formula.max"),render:function(t){return Math.max.apply(Math,d(t.map((function(t){return Number(t)}))))}},{key:"MIN",title:_("formula.min"),render:function(t){return Math.min.apply(Math,d(t.map((function(t){return Number(t)}))))}},{key:"IF",title:_("formula._if"),render:function(t){var e=a(t,3),i=e[0],n=e[1],r=e[2];return i?n:r}},{key:"AND",title:_("formula.and"),render:function(t){return t.every((function(t){return t}))}},{key:"OR",title:_("formula.or"),render:function(t){return t.some((function(t){return t}))}},{key:"CONCAT",title:_("formula.concat"),render:function(t){return t.join("")}}],ht={};function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function dt(t,e,i){t.addEventListener(e,i)}function vt(t,e,i){t.removeEventListener(e,i)}function pt(t){t.xclickoutside&&(vt(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function yt(t,e){t.xclickoutside=function(i){2===i.detail||t.contains(i.target)||(e?e(t):(t.hide(),pt(t)))},dt(window.document.body,"click",t.xclickoutside)}function gt(t,e,i){dt(t,"mousemove",e),t.xEvtUp=function(n){vt(t,"mousemove",e),vt(t,"mouseup",t.xEvtUp),i(n)},dt(t,"mouseup",t.xEvtUp)}function mt(t,e,i,n){Math.abs(t)>Math.abs(e)?n(t>0?"right":"left",t,i):n(e>0?"down":"up",e,i)}ut.forEach((function(t){ht[t.key]=t}));var wt=function(){function t(e,i,n){s(this,t),this.tip="",e&&(this.tip=j("toolbar.".concat(e.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()}))))),i&&(this.tip+=" (".concat(i,")")),this.tag=e,this.shortcut=i,this.value=n,this.el=this.element(),this.change=function(){}}return u(t,[{key:"element",value:function(){var t=this,e=this.tip;return ct("div","".concat(h,"-toolbar-btn")).on("mouseenter",(function(e){t.tip&&function(t,e){if(!e.classList.contains("active")){var i=e.getBoundingClientRect(),n=i.left,r=i.top,l=i.width,a=i.height,o=ct("div","".concat(h,"-tooltip")).html(t).show();document.body.appendChild(o.el);var s=o.box();o.css("left","".concat(n+l/2-s.width/2,"px")).css("top","".concat(r+a+2,"px")),dt(e,"mouseleave",(function(){document.body.contains(o.el)&&document.body.removeChild(o.el)})),dt(e,"click",(function(){document.body.contains(o.el)&&document.body.removeChild(o.el)}))}}(t.tip,e.target)})).attr("data-tooltip",e)}},{key:"setState",value:function(){}}]),t}();function kt(t,e){return kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},kt(t,e)}function bt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&kt(t,e)}function xt(t){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xt(t)}function Rt(t,e){if(e&&("object"===xt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ct(t){return Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ct(t)}var Et=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t){var e;return s(this,r),(e=n.call(this,"div","".concat(h,"-icon"))).iconNameEl=ct("div","".concat(h,"-icon-img ").concat(t)),e.child(e.iconNameEl),e}return u(r,[{key:"setName",value:function(t){this.iconNameEl.className("".concat(h,"-icon-img ").concat(t))}}]),r}(st);var St=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t,e,i,l){var a,o;s(this,r),(o=n.call(this,"div","".concat(h,"-dropdown ").concat(l))).title=t,o.change=function(){},o.headerClick=function(){},"string"==typeof t?o.title=ct("div","".concat(h,"-dropdown-title")).child(t):i&&o.title.addClass("arrow-left"),o.contentEl=ct("div","".concat(h,"-dropdown-content")).css("width",e).hide();for(var c=arguments.length,u=new Array(c>4?c-4:0),f=4;f<c;f++)u[f-4]=arguments[f];return(a=o).setContentChildren.apply(a,u),o.headerEl=ct("div","".concat(h,"-dropdown-header")),o.headerEl.on("click",(function(){"block"!==o.contentEl.css("display")?o.show():o.hide()})).children(o.title,i?ct("div","".concat(h,"-icon arrow-right")).child(ct("div","".concat(h,"-icon-img arrow-down"))):""),o.children(o.headerEl,o.contentEl),o}return u(r,[{key:"setContentChildren",value:function(){var t;this.contentEl.html(""),arguments.length>0&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),yt(this.parent(),(function(){t.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),pt(this.parent())}}]),r}(st);function Ot(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ct(t)););return t}function Dt(){return Dt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=Ot(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}},Dt.apply(this,arguments)}var Tt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.apply(this,arguments)}return u(r,[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,e=this.tag;return this.dd=this.dropdown(),this.dd.change=function(i){return t.change(e,t.getValue(i))},Dt(Ct(r.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}]),r}(wt);function At(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ct(t);if(e){var r=Ct(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Rt(this,i)}}var zt=function(t){bt(i,t);var e=At(i);function i(){var t;s(this,i);var n=new Et("ellipsis"),r=ct("div","".concat(h,"-toolbar-more"));return(t=e.call(this,n,"auto",!1,"bottom-right",r)).moreBtns=r,t.contentEl.css("max-width","420px"),t}return i}(St),Bt=function(t){bt(i,t);var e=At(i);function i(){var t;return s(this,i),(t=e.call(this,"more",void 0,void 0)).el.hide(),t}return u(i,[{key:"dropdown",value:function(){return new zt}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}]),i}(Tt);var It=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.apply(this,arguments)}return u(r,[{key:"element",value:function(){var t=this,e=this.tag;return Dt(Ct(r.prototype),"element",this).call(this).child(new Et(e)).on("click",(function(){return t.change(e)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}]),r}(wt);var Pt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"undo","Ctrl+Z",void 0)}return r}(It);var Ht=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"redo","Ctrl+Y",void 0)}return r}(It);var Ft=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"print","Ctrl+P",void 0)}return r}(It);var Nt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.apply(this,arguments)}return u(r,[{key:"element",value:function(){var t=this,e=this.tag;return Dt(Ct(r.prototype),"element",this).call(this).child(new Et(e)).on("click",(function(){return t.click()}))}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}]),r}(wt);var Mt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"paintformat",void 0,void 0)}return u(r,[{key:"setState",value:function(){}}]),r}(Nt);var Wt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"clearformat",void 0,void 0)}return r}(It),jt=function(t){return t},_t=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=ot(Number(t).toFixed(2).split("\\.")),i=e[0],n=e.slice(1);return[i.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(d(n))}return t},Vt=[{key:"normal",title:_("format.normal"),type:"string",render:jt},{key:"text",title:_("format.text"),type:"string",render:jt},{key:"number",title:_("format.number"),type:"number",label:"1,000.12",render:_t},{key:"percent",title:_("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:_("format.rmb"),type:"number",label:"￥10.00",render:function(t){return"￥".concat(_t(t))}},{key:"usd",title:_("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(_t(t))}},{key:"eur",title:_("format.eur"),type:"number",label:"€10.00",render:function(t){return"€".concat(_t(t))}},{key:"date",title:_("format.date"),type:"date",label:"26/09/2008",render:jt},{key:"time",title:_("format.time"),type:"date",label:"15:59:00",render:jt},{key:"datetime",title:_("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:jt},{key:"duration",title:_("format.duration"),type:"date",label:"24:01:00",render:jt}],qt={};Vt.forEach((function(t){qt[t.key]=t}));var Lt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){var t;s(this,r);var e=Vt.slice(0);return e.splice(2,0,{key:"divider"}),e.splice(8,0,{key:"divider"}),e=e.map((function(e){var i=ct("div","".concat(h,"-item"));return"divider"===e.key?i.addClass("divider"):(i.child(e.title()).on("click",(function(){t.setTitle(e.title()),t.change(e)})),e.label&&i.child(ct("div","label").html(e.label))),i})),t=n.call.apply(n,[this,"Normal","220px",!0,"bottom-left"].concat(d(e)))}return u(r,[{key:"setTitle",value:function(t){for(var e=0;e<Vt.length;e+=1)Vt[e].key===t&&this.title.html(Vt[e].title());this.hide()}}]),r}(St);var Qt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"format",void 0,void 0)}return u(r,[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Lt}}]),r}(Tt),Ut=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],Yt=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function Xt(t){for(var e=0;e<Yt.length;e+=1){var i=Yt[e];if(i.pt===t)return i.px}return t}var $t=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){var t;s(this,r);var e=Ut.map((function(e){return ct("div","".concat(h,"-item")).on("click",(function(){t.setTitle(e.title),t.change(e)})).child(e.title)}));return t=n.call.apply(n,[this,Ut[0].title,"160px",!0,"bottom-left"].concat(d(e)))}return r}(St);var Kt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"font-name",void 0,void 0)}return u(r,[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new $t}}]),r}(Tt);var Jt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){var t;s(this,r);var e=Yt.map((function(e){return ct("div","".concat(h,"-item")).on("click",(function(){t.setTitle("".concat(e.pt)),t.change(e)})).child("".concat(e.pt))}));return t=n.call.apply(n,[this,"10","60px",!0,"bottom-left"].concat(d(e)))}return r}(St);var Zt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"font-size",void 0,void 0)}return u(r,[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Jt}}]),r}(Tt);var Gt=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"font-bold","Ctrl+B",void 0)}return r}(Nt);var te=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"font-italic","Ctrl+I",void 0)}return r}(Nt);var ee=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"underline","Ctrl+U",void 0)}return r}(Nt);var ie=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"strike","Ctrl+U",void 0)}return r}(Nt),ne=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],re=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],le=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function ae(t){var e=this;return ct("td","").child(ct("div","".concat(h,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var oe=function t(){var e,i,n,r=this;s(this,t),this.el=ct("div","".concat(h,"-color-palette")),this.change=function(){};var l=ct("table","").children((e=ct("tbody","")).children.apply(e,[(i=ct("tr","".concat(h,"-theme-color-placeholders"))).children.apply(i,d(ne.map((function(t){return ae.call(r,t)}))))].concat(d(re.map((function(t){var e;return(e=ct("tr","".concat(h,"-theme-colors"))).children.apply(e,d(t.map((function(t){return ae.call(r,t)}))))}))),[(n=ct("tr","".concat(h,"-standard-colors"))).children.apply(n,d(le.map((function(t){return ae.call(r,t)}))))])));this.el.child(l)};var se=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t,e){var i;s(this,r);var l=new Et(t).css("height","16px").css("border-bottom","3px solid ".concat(e)),a=new oe;return a.change=function(t){i.setTitle(t),i.change(t)},i=n.call(this,l,"auto",!1,"bottom-left",a.el)}return u(r,[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}]),r}(St);var ce=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t){return s(this,r),n.call(this,"color",void 0,t)}return u(r,[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new se(t,e)}}]),r}(Tt);var ue=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t){return s(this,r),n.call(this,"bgcolor",void 0,t)}return u(r,[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new se(t,e)}}]),r}(Tt);var he=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']];const fe=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t){var e;s(this,r);var i=new Et("line-type"),l=0,a=he.map((function(i,n){return ct("div","".concat(h,"-item state ").concat(t===i[0]?"checked":"")).on("click",(function(){a[l].toggle("checked"),a[n].toggle("checked"),l=n,e.hide(),e.change(i)})).child(ct("div","".concat(h,"-line-type")).html(i[1]))}));return e=n.call.apply(n,[this,i,"auto",!1,"bottom-left"].concat(d(a)))}return r}(St);function de(){var t;return ct("table","").child((t=ct("tbody","")).children.apply(t,arguments))}function ve(t){var e=this;return ct("td","").child(ct("div","".concat(h,"-border-palette-cell")).child(new Et("border-".concat(t))).on("click",(function(){e.mode=t;var i=e.mode,n=e.style,r=e.color;e.change({mode:i,style:n,color:r})})))}const pe=function t(){var e,i,n=this;s(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new se("line-color",this.color),this.ddColor.change=function(t){n.color=t},this.ddType=new fe(this.style),this.ddType.change=function(t){var e=a(t,1)[0];n.style=e},this.el=ct("div","".concat(h,"-border-palette"));var r=de(ct("tr","").children(ct("td","".concat(h,"-border-palette-left")).child(de((e=ct("tr","")).children.apply(e,d(["all","inside","horizontal","vertical","outside"].map((function(t){return ve.call(n,t)})))),(i=ct("tr","")).children.apply(i,d(["left","top","right","bottom","none"].map((function(t){return ve.call(n,t)})))))),ct("td","".concat(h,"-border-palette-right")).children(ct("div","".concat(h,"-toolbar-btn")).child(this.ddColor.el),ct("div","".concat(h,"-toolbar-btn")).child(this.ddType.el))));this.el.child(r)};var ye=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){var t;s(this,r);var e=new Et("border-all"),i=new pe;return i.change=function(e){t.change(e),t.hide()},t=n.call(this,e,"auto",!1,"bottom-left",i.el)}return r}(St);var ge=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"border",void 0,void 0)}return u(r,[{key:"dropdown",value:function(){return new ye}}]),r}(Tt);var me=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"merge",void 0,void 0)}return u(r,[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}]),r}(Nt);var we=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t,e){var i;s(this,r);var l=new Et("align-".concat(e)),a=t.map((function(t){return(e="align-".concat(t),ct("div","".concat(h,"-item")).child(new Et(e))).on("click",(function(){i.setTitle(t),i.change(t)}));var e}));return i=n.call.apply(n,[this,l,"auto",!0,"bottom-left"].concat(d(a)))}return u(r,[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}]),r}(St);var ke=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t){return s(this,r),n.call(this,"align",void 0,t)}return u(r,[{key:"dropdown",value:function(){var t=this.value;return new we(["left","center","right"],t)}}]),r}(Tt);var be=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t){return s(this,r),n.call(this,"valign",void 0,t)}return u(r,[{key:"dropdown",value:function(){var t=this.value;return new we(["top","middle","bottom"],t)}}]),r}(Tt);var xe=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"textwrap",void 0,void 0)}return r}(Nt);var Re=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"freeze",void 0,void 0)}return r}(Nt);var Ce=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"autofilter",void 0,void 0)}return u(r,[{key:"setState",value:function(){}}]),r}(Nt);var Ee=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){var t;s(this,r);var e=ut.map((function(e){return ct("div","".concat(h,"-item")).on("click",(function(){t.hide(),t.change(e)})).child(e.key)}));return t=n.call.apply(n,[this,new Et("formula"),"180px",!0,"bottom-left"].concat(d(e)))}return r}(St);var Se=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(){return s(this,r),n.call(this,"formula",void 0,void 0)}return u(r,[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Ee}}]),r}(Tt);function Oe(){return ct("div","".concat(h,"-toolbar-divider"))}function De(){var t=this;this.btnsWidthStyle=[],this.items.forEach((function(e){Array.isArray(e)?e.forEach((function(e){var i=e.el;Te.call(t,i)})):Te.call(t,e)}))}function Te(t){var e=t.box(),i=t.computedStyle(),n=i.marginLeft,r=i.marginRight;this.btnsWidthStyle.push([t,e.width+parseInt(n,10)+parseInt(r,10)])}function Ae(){var t,e,i=this.el,n=this.btns,r=this.moreEl,l=this.btnsWidthStyle,o=r.dd,s=o.moreBtns,c=o.contentEl;i.css("width","".concat(this.widthFn(),"px"));var u=i.box(),h=96,f=12,d=[],v=[];l.forEach((function(t,e){var i=a(t,2),n=i[0],r=i[1];h+=r,e===l.length-1||h<u.width?d.push(n):(f+=r,v.push(n))})),(t=n.html("")).children.apply(t,d),(e=s.html("")).children.apply(e,v),c.css("width","".concat(f,"px")),v.length>0?r.show():r.hide()}function ze(t){var e=this,i=new wt;i.el.on("click",(function(){t.onClick&&t.onClick(e.data.getData(),e.data)})),i.tip=t.tip||"";var n=t.el;if(t.icon&&(n=ct("img").attr("src",t.icon)),n){var r=ct("div","".concat(h,"-icon"));r.child(n),i.el.child(r)}return i}var Be=function(){function t(e,i){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s(this,t),this.data=e,this.change=function(){},this.widthFn=i,this.isHide=r;var l=e.defaultStyle();this.items=[[this.undoEl=new Pt,this.redoEl=new Ht,new Ft,this.paintformatEl=new Mt,this.clearformatEl=new Wt],Oe(),[this.formatEl=new Qt],Oe(),[this.fontEl=new Kt,this.fontSizeEl=new Zt],Oe(),[this.boldEl=new Gt,this.italicEl=new te,this.underlineEl=new ee,this.strikeEl=new ie,this.textColorEl=new ce(l.color)],Oe(),[this.fillColorEl=new ue(l.bgcolor),this.borderEl=new ge,this.mergeEl=new me],Oe(),[this.alignEl=new ke(l.align),this.valignEl=new be(l.valign),this.textwrapEl=new xe],Oe(),[this.freezeEl=new Re,this.autofilterEl=new Ce,this.formulaEl=new Se]];var a=e.settings.extendToolbar,o=void 0===a?{}:a;if(o.left&&o.left.length>0){this.items.unshift(Oe());var c=o.left.map(ze.bind(this));this.items.unshift(c)}if(o.right&&o.right.length>0){this.items.push(Oe());var u=o.right.map(ze.bind(this));this.items.push(u)}this.items.push([this.moreEl=new Bt]),this.el=ct("div","".concat(h,"-toolbar")),this.btns=ct("div","".concat(h,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){n.btns.child(t.el),t.change=function(){n.change.apply(n,arguments)}})):n.btns.child(t.el)})),this.el.child(this.btns),r?this.el.hide():(this.reset(),setTimeout((function(){De.call(n),Ae.call(n)}),0),dt(window,"resize",(function(){Ae.call(n)})))}return u(t,[{key:"paintFormatActive",value:function(){return this.paintformatEl.active()}},{key:"paintFormatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutoFilter());var i=e.font,n=e.format;this.formatEl.setState(n),this.fontEl.setState(i.name),this.fontSizeEl.setState(i.size),this.boldEl.setState(i.bold),this.italicEl.setState(i.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}]),t}();function Ie(){return window.devicePixelRatio||1}function Pe(){return Ie()-.5}function He(t){return parseInt(t*Ie()+"",10)}function Fe(t){var e=He(t);return e>0?e-.5:.5}var Ne=function(){function t(e,i,n,r){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;s(this,t),this.x=e,this.y=i,this.width=n,this.height=r,this.padding=l,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return u(t,[{key:"setBorders",value:function(t){var e=t.top,i=t.bottom,n=t.left,r=t.right;e&&(this.borderTop=e),r&&(this.borderRight=r),i&&(this.borderBottom=i),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,i=this.padding,n=this.x;return"left"===t?n+=i:"center"===t?n+=e/2:"right"===t&&(n+=e-i),n}},{key:"texty",value:function(t,e){var i=this.height,n=this.padding,r=this.y;return"top"===t?r+=n:"middle"===t?r+=i/2-e/2:"bottom"===t&&(r+=i-n-e),r}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,i=this.width;return[[t+i,e],[t+i,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,i=this.width,n=this.height;return[[t,e+n],[t+i,e+n]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),t}();function Me(t,e,i,n,r,l,a){var o={x:0,y:0};"underline"===t?o.y="bottom"===r?0:"top"===r?-(l+2):-l/2:"strike"===t&&("bottom"===r?o.y=l/2:"top"===r&&(o.y=-(l/2+2))),"center"===n?o.x=a/2:"right"===n&&(o.x=a),this.line([e-o.x,i-o.y],[e-o.x+a,i-o.y])}var We=function(){function t(e,i,n){s(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(i,n),this.ctx.scale(Ie(),Ie())}return u(t,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=He(t),this.el.height=He(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,i=t.height;return this.ctx.clearRect(0,0,e,i),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(He(t),He(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,i,n){return this.ctx.clearRect(t,e,i,n),this}},{key:"fillRect",value:function(t,e,i,n){return this.ctx.fillRect(He(t)-.5,He(e)-.5,He(i),He(n)),this}},{key:"fillText",value:function(t,e,i){return this.ctx.fillText(t,He(e),He(i)),this}},{key:"text",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=this.ctx,a=n.align,o=n.valign,s=n.font,c=n.color,u=n.strike,h=n.underline,f=e.textx(a);l.save(),l.beginPath(),this.attr({textAlign:a,textBaseline:o,font:"".concat(s.italic?"italic":""," ").concat(s.bold?"bold":""," ").concat(He(s.size),"px ").concat(s.name),fillStyle:c,strokeStyle:c});var d="".concat(t).split("\n"),v=e.innerWidth(),p=[];d.forEach((function(t){var e=l.measureText(t).width;if(r&&e>He(v)){for(var i={w:0,len:0,start:0},n=0;n<t.length;n+=1)i.w>=He(v)&&(p.push(t.substr(i.start,i.len)),i={w:0,len:0,start:n}),i.len+=1,i.w+=l.measureText(t[n]).width+1;i.len>0&&p.push(t.substr(i.start,i.len))}else p.push(t)}));var y=(p.length-1)*(s.size+2),g=e.texty(o,y);return p.forEach((function(t){var e=l.measureText(t).width;i.fillText(t,f,g),u&&Me.call(i,"strike",f,g,a,o,s.size,e),h&&Me.call(i,"underline",f,g,a,o,s.size,e),g+=s.size+2})),l.restore(),this}},{key:"border",value:function(t,e){var i=this.ctx;return i.lineWidth=Pe,i.strokeStyle=e,"medium"===t?i.lineWidth=He(2)-.5:"thick"===t?i.lineWidth=He(3):"dashed"===t?i.setLineDash([He(3),He(2)]):"dotted"===t?i.setLineDash([He(1),He(1)]):"double"===t&&i.setLineDash([He(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],i=a(e,2),n=i[0],r=i[1];t.moveTo(Fe(n),Fe(r));for(var l=1;l<arguments.length;l+=1){var o=l<0||arguments.length<=l?void 0:arguments[l],s=a(o,2),c=s[0],u=s[1];t.lineTo(Fe(c),Fe(u))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var i=t.borderTop,n=t.borderRight,r=t.borderBottom,l=t.borderLeft;i&&(this.border.apply(this,d(i)),this.line.apply(this,d(t.topxys()))),n&&(this.border.apply(this,d(n)),this.line.apply(this,d(t.rightxys()))),r&&(this.border.apply(this,d(r)),this.line.apply(this,d(t.bottomxys()))),l&&(this.border.apply(this,d(l)),this.line.apply(this,d(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,i=t.x,n=t.y,r=i+t.width-15,l=n+t.height-15;e.save(),e.beginPath(),e.moveTo(He(r),He(l)),e.lineTo(He(r+8),He(l)),e.lineTo(He(r+4),He(l+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,i=t.x,n=t.y,r=i+t.width-1;e.save(),e.beginPath(),e.moveTo(He(r-8),He(n-1)),e.lineTo(He(r),He(n-1)),e.lineTo(He(r),He(n+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,i=t.x,n=t.y,r=i+t.width-1;e.save(),e.beginPath(),e.moveTo(He(r-8),He(n-1)),e.lineTo(He(r),He(n-1)),e.lineTo(He(r),He(n+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var i=this.ctx,n=t.x,r=t.y,l=t.width,a=t.height,o=t.bgcolor;i.save(),i.beginPath(),i.fillStyle=o||"#fff",i.rect(Fe(n+1),Fe(r+1),He(l-2),He(a-2)),i.clip(),i.fill(),e(),i.restore()}}]),t}();var je=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return s(this,r),(e=n.call(this,"div","".concat(h,"-button ").concat(i))).child(j("button.".concat(t))),e}return r}(st),_e=function(t){for(var e=[],i=[],n=[],r=0,l="",o=1,s="",c=0;c<t.length;c+=1){var u=t.charAt(c);if(" "!==u){if(u>="a"&&u<="z")n.push(u.toUpperCase());else if(u>="0"&&u<="9"||u>="A"&&u<="Z"||"."===u)n.push(u);else if('"'===u){for(c+=1;'"'!==t.charAt(c);)n.push(t.charAt(c)),c+=1;i.push('"'.concat(n.join(""))),n=[]}else if("-"===u&&/[+\-*/,(]/.test(s))n.push(u);else{if("("!==u&&n.length>0&&i.push(n.join("")),")"===u){var h=e.pop();if(2===r)try{for(var f=a(S(i.pop()),2),d=f[0],v=f[1],p=a(S(i.pop()),2),y=p[0],g=p[1],m=0,w=y;w<=d;w+=1)for(var k=g;k<=v;k+=1)i.push(O(w,k)),m+=1;i.push([h,m])}catch(t){}else if(1===r||3===r)3===r&&i.push(l),i.push([h,o]),o=1;else for(;"("!==h&&(i.push(h),!(e.length<=0));)h=e.pop();r=0}else if("="===u||">"===u||"<"===u){var b=t.charAt(c+1);l=u,"="!==b&&"-"!==b||(l+=b,c+=1),r=3}else if(":"===u)r=2;else if(","===u)3===r&&i.push(l),r=1,o+=1;else if("("===u&&n.length>0)e.push(n.join(""));else{if(e.length>0&&("+"===u||"-"===u)){var x=e[e.length-1];if("("!==x&&i.push(e.pop()),"*"===x||"/"===x)for(;e.length>0&&"("!==(x=e[e.length-1]);)i.push(e.pop())}else if(e.length>0){var R=e[e.length-1];"*"!==R&&"/"!==R||i.push(e.pop())}e.push(u)}n=[]}s=u}}for(n.length>0&&i.push(n.join(""));e.length>0;)i.push(e.pop());return i},Ve=function(t,e){var i=a(t,1)[0],n=t;if('"'===i)return t.substring(1);var r=1;if("-"===i&&(n=t.substring(1),r=-1),n[0]>="0"&&n[0]<="9")return r*Number(n);var l=a(S(n),2);return r*e(l[0],l[1])},qe=function(t,e,i,n){for(var r=[],l=0;l<t.length;l+=1){var o=t[l],s=o[0];if("+"===o){var c=r.pop();r.push(y("+",r.pop(),c))}else if("-"===o)if(1===r.length){var u=r.pop();r.push(y("*",u,-1))}else{var h=r.pop();r.push(y("-",r.pop(),h))}else if("*"===o)r.push(y("*",r.pop(),r.pop()));else if("/"===o){var f=r.pop();r.push(y("/",r.pop(),f))}else if("="===s||">"===s||"<"===s){var d=r.pop();Number.isNaN(d)||(d=Number(d));var v=r.pop();Number.isNaN(v)||(v=Number(v));var p=!1;"="===s?p=v===d:">"===o?p=v>d:">="===o?p=v>=d:"<"===o?p=v<d:"<="===o&&(p=v<=d),r.push(p)}else if(Array.isArray(o)){for(var g=a(o,2),m=g[0],w=g[1],k=[],b=0;b<w;b+=1)k.push(r.pop());r.push(e[m].render(k.reverse()))}else{if(n.includes(o))return 0;(s>="a"&&s<="z"||s>="A"&&s<="Z")&&n.push(o),r.push(Ve(o,i)),n.pop()}}return r[0]};const Le=function t(e,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===e[0]){var l=_e(e.substring(1));return l.length<=0?e:qe(l,i,(function(e,l){return t(n(e,l),i,n,r)}),r)}return e};function Qe(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ue(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Qe(Object(i),!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Qe(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Ye={fillStyle:"#f4f5f8"},Xe={fillStyle:"#fff",lineWidth:Pe,strokeStyle:"#e6e6e6"};function $e(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=t.cellRect(e,i),l=r.left,a=r.top,o=r.width,s=r.height;return new Ne(l,a+n,o,s,5)}function Ke(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=e.sortedRowMap,a=e.rows,o=e.cols;if(!a.isHide(i)&&!o.isHide(n)){var s=i;l.has(i)&&(s=l.get(i));var c=e.getCell(s,n);if(null!==c){var u=!1;"editable"in c&&!1===c.editable&&(u=!0);var h=e.getCellStyleOrDefault(s,n),f=$e(e,i,n,r);f.bgcolor=h.bgcolor,void 0!==h.border&&(f.setBorders(h.border),t.strokeBorders(f)),t.rect(f,(function(){var r="";r=e.settings.evalPaused?c.text||"":Le(c.text||"",ht,(function(t,i){return e.getCellTextOrDefault(i,t)})),h.format&&(r=qt[h.format].render(r));var l=Ue({},h.font);l.size=Xt(l.size),t.text(r,f,{align:h.align,valign:h.valign,font:l,color:h.color,strike:h.strike,underline:h.underline},h.textwrap),e.validations.getError(i,n)&&t.error(f),u&&t.frozen(f)}))}}}function Je(t){var e=this.data,i=this.draw;if(t){var n=e.autoFilter;if(!n.active())return;var r=n.hrange();t.intersects(r)&&r.each((function(t,n){var r=$e(e,t,n);i.dropdown(r)}))}}function Ze(t,e,i,n,r){var l=this.draw,a=this.data;l.save(),l.translate(e,i).translate(n,r);var o=a.exceptRowSet,s=a.exceptRowTotalHeight(t.sri,t.eri);l.save(),l.translate(0,-s),t.each((function(t,e){Ke(l,a,t,e)}),(function(t){return function(t){var e=o.has(t);if(e){var i=a.rows.getHeight(t);l.translate(0,-i)}return!e}(t)})),l.restore();var c=new Set;l.save(),l.translate(0,-s),a.eachMergesInView(t,(function(t){var e=t.sri,i=t.sci,n=t.eri;if(o.has(e)){if(!c.has(e)){c.add(e);var r=a.rows.sumHeight(e,n+1);l.translate(0,-r)}}else Ke(l,a,e,i)})),l.restore(),Je.call(this,t),l.restore()}function Ge(t,e,i,n){var r=this.draw;r.save(),r.attr({fillStyle:"rgba(75,137,255,0.08)"}).fillRect(t,e,i,n),r.restore()}function ti(t,e,i,n,r,l){var a=this,o=this.draw,s=this.data,c=e.h,u=e.w,h=l+n,f=r+i;o.save(),o.attr(Ye),"all"!==t&&"left"!==t||o.fillRect(0,h,i,c),"all"!==t&&"top"!==t||o.fillRect(f,0,u,n);var d=s.selector.range,v=d.sri,p=d.eri,y=d.sci,g=d.eci;o.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(He(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:Pe(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(s.rowEach(e.sri,e.eri,(function(t,e,n){var r=h+e,l=t;o.line([0,r],[i,r]),v<=l&&l<p+1&&Ge.call(a,0,r,i,n),o.fillText(l+1,i/2,r+n/2),t>0&&s.rows.isHide(t-1)&&(o.save(),o.attr({strokeStyle:"#c6c6c6"}),o.line([5,r+5],[i-5,r+5]),o.restore())})),o.line([0,c+h],[i,c+h]),o.line([i,h],[i,c+h])),"all"!==t&&"top"!==t||(s.colEach(e.sci,e.eci,(function(t,e,i){var r=f+e,l=t;o.line([r,0],[r,n]),y<=l&&l<g+1&&Ge.call(a,r,0,i,n),o.fillText(C(l),r+i/2,n/2),t>0&&s.cols.isHide(t-1)&&(o.save(),o.attr({strokeStyle:"#c6c6c6"}),o.line([r+5,5],[r+5,n-5]),o.restore())})),o.line([u+f,0],[u+f,n]),o.line([0,n],[u+f,n])),o.restore()}function ei(t,e){var i=this.draw;i.save(),i.attr({fillStyle:"#ff0000"}).fillRect(0,0,t,e),i.restore()}function ii(t,e,i,n,r){var l=t.sri,a=t.sci,o=t.eri,s=t.eci,c=t.w,u=t.h,h=this.draw,f=this.data,d=f.settings;h.save(),h.attr(Xe).translate(e+n,i+r),d.showGrid?(f.rowEach(l,o,(function(t,e,i){t!==l&&h.line([0,e],[c,e]),t===o&&h.line([0,e+i],[c,e+i])})),f.colEach(a,s,(function(t,e,i){t!==a&&h.line([e,0],[e,u]),t===s&&h.line([e+i,0],[e+i,u])})),h.restore()):h.restore()}function ni(t,e,i,n){var r=this.draw,l=this.data,a=l.viewWidth()-t,o=l.viewHeight()-e;r.save().translate(t,e).attr({strokeStyle:"rgba(75,137,255,.6)"}),r.line([0,n],[a,n]),r.line([i,0],[i,o]),r.restore()}const ri=function(){function t(e,i){s(this,t),this.el=e,this.draw=new We(e,i.viewWidth(),i.viewHeight()),this.data=i}return u(t,[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,i=t.cols.indexWidth,n=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var r=t.viewRange(),l=t.freezeTotalWidth(),o=t.freezeTotalHeight(),s=t.scroll,c=s.x,u=s.y;ii.call(this,r,i,n,l,o),Ze.call(this,r,i,n,-c,-u),ti.call(this,"all",r,i,n,l,o),ei.call(this,i,n);var h=a(t.freeze,2),f=h[0],d=h[1];if(f>0||d>0){if(f>0){var v=r.clone();v.sri=0,v.eri=f-1,v.h=o,ii.call(this,v,i,n,l,0),Ze.call(this,v,i,n,-c,0),ti.call(this,"top",v,i,n,l,0)}if(d>0){var p=r.clone();p.sci=0,p.eci=d-1,p.w=l,ii.call(this,p,i,n,0,o),ti.call(this,"left",p,i,n,0,o),Ze.call(this,p,i,n,0,-u)}var y=t.freezeViewRange();ii.call(this,y,i,n,0,0),ti.call(this,"all",y,i,n,0,0),Ze.call(this,y,i,n,0,0),ni.call(this,i,n,l,o)}}},{key:"clear",value:function(){this.draw.clear()}}]),t}();var li=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],ai=["landscape","portrait"];function oi(t){return parseInt(String(96*t),10)}function si(t){"cancel"===t?this.el.hide():this.toPrint()}function ci(t){var e=this.paper,i=t.target.value,n=li[i];e.w=oi(n[1]),e.h=oi(n[2]),this.preview()}function ui(t){var e=this.paper,i=t.target.value;e.orientation=ai[i],this.preview()}var hi=function(){function t(e){var i,n;s(this,t),this.paper={w:oi(li[0][1]),h:oi(li[0][2]),padding:50,orientation:ai[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=ct("div","".concat(h,"-print")).children(ct("div","".concat(h,"-print-bar")).children(ct("div","-title").child("Print settings"),ct("div","-right").children(ct("div","".concat(h,"-buttons")).children(new je("cancel").on("click",si.bind(this,"cancel")),new je("next","primary").on("click",si.bind(this,"next"))))),ct("div","".concat(h,"-print-content")).children(this.contentEl=ct("div","-content"),ct("div","-sider").child(ct("form","").children(ct("fieldset","").children(ct("label","").child("".concat(j("print.size"))),(i=ct("select","")).children.apply(i,d(li.map((function(t,e){return ct("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))})))).on("change",ci.bind(this))),ct("fieldset","").children(ct("label","").child("".concat(j("print.orientation"))),(n=ct("select","")).children.apply(n,d(ai.map((function(t,e){return ct("option","").attr("value",e).child("".concat(j("print.orientations")[e]))})))).on("change",ui.bind(this))))))).hide()}return u(t,[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,i=this.paper,n=i.width,r=i.height,l=i.padding,a=n-2*l,o=r-2*l,s=e.contentRange(),c=parseInt(s.h/o+"",10)+1,u=a/s.w,f=l,d=l;u>1&&(f+=(a-s.w)/2);var v=0,p=0;this.contentEl.html(""),this.canvases=[];for(var y={sri:0,sci:0,eri:0,eci:0},g=function(i){var l=0,a=0,c=ct("div","".concat(h,"-canvas-card")),g=ct("canvas","".concat(h,"-canvas"));t.canvases.push(g.el);var m=new We(g.el,n,r);for(m.save(),m.translate(f,d),u<1&&m.scale(u,u);v<=s.eri;v+=1){var w=e.rows.getHeight(v);if(!((l+=w)<o)){a=-(l-w);break}for(var k=0;k<=s.eci;k+=1)Ke(m,e,v,k,p),y.eci=k}y.eri=v,m.restore(),m.save(),m.translate(f,d),u<1&&m.scale(u,u);var b=p;e.eachMergesInView(y,(function(t){var i=t.sri,n=t.sci;Ke(m,e,i,n,b)})),m.restore(),y.sri=y.eri,y.sci=y.eci,p+=a,t.contentEl.child(ct("div","".concat(h,"-canvas-card-wraper")).child(c.child(g)))},m=0;m<c;m+=1)g();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=ct("iframe","").hide().el;window.document.body.appendChild(e);var i=e.contentWindow,n=i.document,r=document.createElement("style");r.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),n.head.appendChild(r),this.canvases.forEach((function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),n.body.appendChild(e)})),i.print()}}]),t}(),fi=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;s(this,t),this.moving=!1,this.vertical=i,this.el=ct("div","".concat(h,"-resizer ").concat(i?"vertical":"horizontal")).children(this.unhideHoverEl=ct("div","".concat(h,"-resizer-hover")).on("dblclick.stop",(function(t){return e.handleDblclick(t)})).css("position","absolute").hide(),this.hoverEl=ct("div","".concat(h,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=ct("div","".concat(h,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=n,this.unhideFn=function(){}}return u(t,[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var i=this.moving,n=this.vertical,r=this.hoverEl,l=this.lineEl,a=this.el,o=this.unhideHoverEl;if(!i){this.cRect=t;var s=t.left,c=t.top,u=t.width,h=t.height;a.offset({left:n?s+u-5:s,top:n?c:c+h-5}).show(),r.offset({width:n?5:u,height:n?h:5}),l.offset({width:n?0:e.width,height:n?e.height:0}),o.offset({left:n?5-u:s,top:n?c:5-h,width:n?5:u,height:n?h:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide()}},{key:"handleDblclick",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,i=t,n=this.el,r=this.lineEl,l=this.cRect,a=this.vertical,o=this.minDistance,s=a?l.width:l.height;r.show(),gt(window,(function(t){e.moving=!0,null!==i&&1===t.buttons&&(a?(s+=t.movementX)>o&&n.css("left","".concat(l.left+s,"px")):(s+=t.movementY)>o&&n.css("top","".concat(l.top+s,"px")),i=t)}),(function(){i=null,r.hide(),e.moving=!1,e.hide(),e.finishedFn&&(s<o&&(s=o),e.finishedFn(l,s))}))}}]),t}(),di=function(){function t(e){var i=this;s(this,t),this.vertical=e,this.moveFn=null,this.el=ct("div","".concat(h,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=ct("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(t){var e=t.target,n=e.scrollTop,r=e.scrollLeft;i.moveFn&&i.moveFn(i.vertical?n:r,t)}))}return u(t,[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var i=t-1;if(e>i){var n=this.vertical?"height":"width";this.el.css(n,"".concat(i-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(n,"".concat(e,"px"))}else this.el.hide();return this}}]),t}();function vi(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function pi(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function yi(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function gi(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:case 39:default:t.stopPropagation();break;case 38:vi.call(this,t);break;case 40:pi.call(this,t);break;case 13:case 9:yi.call(this,t)}}var mi=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";s(this,t),this.filterItems=[],this.items=e,this.el=ct("div","".concat(h,"-suggest")).css("width",n).hide(),this.itemClick=i,this.itemIndex=-1}return u(t,[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),pt(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,i=this,n=this.items;if(/^\s*$/.test(t)||(n=n.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),n=n.map((function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var n=ct("div","".concat(h,"-item")).child(e).on("click.stop",(function(){i.itemClick(t),i.hide()}));return t.label&&n.child(ct("div","label").html(t.label)),n})),this.filterItems=n,!(n.length<=0)){var r=this.el;(e=r.html("")).children.apply(e,d(n)).show(),yt(r.parent(),(function(){i.hide()}))}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return gi.call(e,t)}))}}]),t}();function wi(t,e){t.setMonth(t.getMonth()+e)}function ki(t,e){var i=new Date(t);return i.setDate(e-t.getDay()+1),i}var bi=function(){function t(e){var i,n=this;s(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=ct("div","calendar-header-left"),this.bodyEl=ct("tbody",""),this.buildAll(),this.el=ct("div","".concat(h,"-calendar")).children(ct("div","calendar-header").children(this.headerLeftEl,ct("div","calendar-header-right").children(ct("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new Et("chevron-left")),ct("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new Et("chevron-right")))),ct("table","calendar-body").children(ct("thead","").child((i=ct("tr","")).children.apply(i,d(j("calendar.weeks").map((function(t){return ct("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}}return u(t,[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){wi(this.value,-1),this.buildAll()}},{key:"next",value:function(){wi(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(j("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,i=this.value,n=this.cvalue,r=this.bodyEl,l=function(t,e,i){for(var n=new Date(t,e,1,23,59,59),r=Array(6).fill([]),l=0;l<6;l+=1)for(var a=0;a<7;a+=1){var o=ki(n,7*l+a),s=o.getMonth()!==e,c=o.getMonth()===i.getMonth()&&o.getDate()===i.getDate();r[l][a]={d:o,disabled:s,active:c}}return r}(i.getFullYear(),i.getMonth(),n).map((function(t){var i,n=t.map((function(t){var i="cell";return t.disabled&&(i+=" disabled"),t.active&&(i+=" active"),ct("td","").child(ct("div",i).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(i=ct("tr","")).children.apply(i,d(n))}));(t=r.html("")).children.apply(t,d(l))}}]),t}(),xi=function(){function t(){s(this,t),this.calendar=new bi(new Date),this.el=ct("div","".concat(h,"-datepicker")).child(this.calendar.el).hide()}return u(t,[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(i){t(i),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}]),t}();function Ri(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,i=this.textEl,n=this.areaOffset,r=t.split("\n"),l=Math.max.apply(Math,d(r.map((function(t){return t.length})))),a=e.offset().width/t.length,o=(l+1)*a+5,s=this.viewFn().width-n.left-a,c=r.length;if(o>n.width){var u=o;o>s&&(u=s,c+=parseInt(o/s,10),c+=o%s>0?1:0),i.css("width","".concat(u,"px"))}(c*=this.rowHeight)>n.height&&i.css("height","".concat(c,"px"))}}function Ci(t,e){var i=t.target,n=i.value,r=i.selectionEnd,l="".concat(n.slice(0,r)).concat(e).concat(n.slice(r));i.value=l,i.setSelectionRange(r+1,r+1),this.inputText=l,this.textlineEl.html(l),Ri.call(this)}function Ei(t){var e=t.keyCode,i=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&i&&(Ci.call(this,t,"\n"),t.stopPropagation()),13!==e||i||t.preventDefault()}function Si(t){var e=t.target.value,i=this.suggest,n=this.textlineEl,r=this.validator,l=this.cell;if(null!==l)if("editable"in l&&!0===l.editable||void 0===l.editable){if(this.inputText=e,r)"list"===r.type?i.search(e):i.hide();else{var a=e.lastIndexOf("=");-1!==a?i.search(e.substring(a+1)):i.hide()}n.html(e),Ri.call(this),this.change("input",e)}else t.target.value=l.text||"";else{if(this.inputText=e,r)"list"===r.type?i.search(e):i.hide();else{var o=e.lastIndexOf("=");-1!==o?i.search(e.substring(o+1)):i.hide()}n.html(e),Ri.call(this),this.change("input",e)}}function Oi(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function Di(t,e){var i=this.textEl,n=this.textlineEl;i.el.blur(),i.val(t),n.html(t),Oi.call(this,e)}function Ti(t){var e=this.inputText,i=this.validator,n=0;if(i&&"list"===i.type)this.inputText=t,n=this.inputText.length;else{var r=e.lastIndexOf("="),l=e.substring(0,r+1),a=e.substring(r+1);a=-1!==a.indexOf(")")?a.substring(a.indexOf(")")):"",this.inputText="".concat(l+t.key,"("),n=this.inputText.length,this.inputText+=")".concat(a)}Di.call(this,this.inputText,n)}function Ai(){this.suggest.setItems(this.formulas)}var zi=function(){function t(e,i,n){var r=this;s(this,t),this.viewFn=i,this.rowHeight=n,this.formulas=e,this.suggest=new mi(e,(function(t){Ti.call(r,t)})),this.datepicker=new xi,this.datepicker.change((function(t){r.setText(function(t){var e=t.getMonth()+1,i=t.getDate();return e>10&&(e="0".concat(e)),i<10&&(i="0".concat(i)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(i)}(t)),r.clear()})),this.areaEl=ct("div","".concat(h,"-editor-area")).children(this.textEl=ct("textarea","").on("input",(function(t){return Si.call(r,t)})).on("paste.stop",(function(){})).on("keydown",(function(t){return Ei.call(r,t)})),this.textlineEl=ct("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=ct("div","".concat(h,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}return u(t,[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),Ai.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",i=this.textEl,n=this.areaEl,r=this.suggest,l=this.freeze,a=this.el;if(t){this.areaOffset=t;var o=t.left,s=t.top,c=t.width,u=t.height,h=t.l,f=t.t,d={left:0,top:0};l.w>h&&l.h>f||(l.w<h&&l.h<f?(d.left=l.w,d.top=l.h):l.w>h?d.top=l.h:l.h>f&&(d.left=l.w)),a.offset(d),n.offset({left:o-d.left-.8,top:s-d.top-.8}),i.offset({width:c-9+.8,height:u-3+.8});var v={left:0};v[e]=u,r.setOffset(v),r.hide()}}},{key:"setCell",value:function(t,e){var i=this.el,n=this.datepicker,r=this.suggest;i.show(),this.cell=t;var l=t&&t.text||"";if(this.setText(l),this.validator=e,e){var a=e.type;"date"===a&&(n.show(),/^\s*$/.test(l)||n.setValue(l)),"list"===a&&(r.setItems(e.values()),r.search(""))}}},{key:"setText",value:function(t){this.inputText=t,Di.call(this,t,t.length),Ri.call(this)}}]),t}(),Bi=[{key:"copy",title:_("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:_("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:_("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:_("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:_("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:_("contextmenu.insertRow")},{key:"insert-column",title:_("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:_("contextmenu.deleteRow")},{key:"delete-column",title:_("contextmenu.deleteColumn")},{key:"delete-cell-text",title:_("contextmenu.deleteCellText")},{key:"hide",title:_("contextmenu.hide")},{key:"divider"},{key:"validation",title:_("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:_("contextmenu.cellprintable")},{key:"cell-non-printable",title:_("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:_("contextmenu.celleditable")},{key:"cell-non-editable",title:_("contextmenu.cellnoneditable")}];function Ii(t){var e=this;return"divider"===t.key?ct("div","".concat(h,"-item divider")):ct("div","".concat(h,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),ct("div","label").child(t.label||""))}function Pi(){var t=this;return Bi.map((function(e){return Ii.call(t,e)}))}var Hi=function(){function t(e){var i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s(this,t),this.menuItems=Pi.call(this),this.el=(i=ct("div","".concat(h,"-contextmenu"))).children.apply(i,d(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=n,this.setMode("range")}return u(t,[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),pt(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var i=this.el,n=i.show().offset().width,r=this.viewFn(),l=r.height/2,a=t;r.width-t<=n&&(a-=n),i.css("left","".concat(a,"px")),e>l?i.css("bottom","".concat(r.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):i.css("top","".concat(e,"px")).css("max-height","".concat(r.height-e,"px")).css("bottom","auto"),yt(i)}}}]),t}(),Fi=10,Ni=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];s(this,t),this.useHideInput=i,this.autoFocus=n,this.inputChange=function(){},this.cornerEl=ct("div","".concat(h,"-selector-corner")),this.areaEl=ct("div","".concat(h,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=ct("div","".concat(h,"-selector-clipboard")).hide(),this.autofillEl=ct("div","".concat(h,"-selector-autofill")).hide(),this.el=ct("div","".concat(h,"-selector")).css("z-index","".concat(Fi)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),i&&(this.hideInput=ct("input","").on("compositionend",(function(t){e.inputChange(t.target.value)})),this.el.child(this.hideInputDiv=ct("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=ct("div","hide-input").child(this.hideInput))),Fi+=1}return u(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,i=t.top,n={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:i-.8};this.areaEl.offset(n).show(),this.useHideInput&&(this.hideInputDiv.offset(n),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}},{key:"setClipboardOffset",value:function(t){var e=t.left,i=t.top,n=t.width,r=t.height;this.clipboardEl.offset({left:e,top:i,width:n-5,height:r-5})}},{key:"showAutofill",value:function(t){var e=t.left,i=t.top,n=t.width,r=t.height;this.autofillEl.offset({width:n-3,height:r-3,left:e,top:i}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function Mi(t){var e=this.data,i=t.left,n=t.top,r=t.width,l=t.height,a=t.scroll,o=t.l,s=t.t,c=e.freezeTotalWidth(),u=e.freezeTotalHeight(),h=i-c;c>o&&(h-=a.x);var f=n-u;return u>s&&(f-=a.y),{left:h,top:f,width:r,height:l}}function Wi(t){var e=this.data,i=t.left,n=t.width,r=t.height,l=t.l,a=t.t,o=t.scroll,s=e.freezeTotalWidth(),c=i-s;return s>l&&(c-=o.x),{left:c,top:a,width:n,height:r}}function ji(t){var e=this.data,i=t.top,n=t.width,r=t.height,l=t.l,a=t.t,o=t.scroll,s=e.freezeTotalHeight(),c=i-s;return s>a&&(c-=o.y),{left:l,top:c,width:n,height:r}}function _i(t){this.fourthQuadrant.setAreaOffset(Mi.call(this,t))}function Vi(t){this.secondQuadrant.setAreaOffset(t)}function qi(t){this.firstQuadrant.setAreaOffset(Wi.call(this,t))}function Li(t){this.thirdQuadrant.setAreaOffset(ji.call(this,t))}function Qi(t){this.thirdQuadrant.setClipboardOffset(ji.call(this,t))}function Ui(t){this.fourthQuadrant.setClipboardOffset(Mi.call(this,t))}function Yi(t){this.secondQuadrant.setClipboardOffset(t)}function Xi(t){this.firstQuadrant.setClipboardOffset(Wi.call(this,t))}function $i(t){_i.call(this,t),Vi.call(this,t),qi.call(this,t),Li.call(this,t)}function Ki(t){Ui.call(this,t),Yi.call(this,t),Xi.call(this,t),Qi.call(this,t)}var Ji=function(){function t(e){var i=this;s(this,t);var n=e.settings.autoFocus;this.inputChange=function(){},this.data=e,this.secondQuadrant=new Ni,this.firstQuadrant=new Ni,this.thirdQuadrant=new Ni,this.fourthQuadrant=new Ni(!0,n),this.fourthQuadrant.inputChange=function(t){i.inputChange(t)},this.fourthQuadrant.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=ct("div","".concat(h,"-selectors")).children(this.secondQuadrant.el,this.firstQuadrant.el,this.thirdQuadrant.el,this.fourthQuadrant.el).hide(),this.lastri=-1,this.lastci=-1,Fi+=1}return u(t,[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.secondQuadrant,i=this.firstQuadrant,n=this.thirdQuadrant,r=this.fourthQuadrant,l=t.freezeTotalHeight(),a=t.freezeTotalWidth();l>0||a>0?(e.setOffset({width:a,height:l}),i.setOffset({left:a,height:l}),n.setOffset({top:l,width:a}),r.setOffset({left:a,top:l})):(e.hide(),i.hide(),n.hide(),r.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();$i.call(this,t),Ki.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();_i.call(this,t),qi.call(this,t),Ui.call(this,e),Xi.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();_i.call(this,t),Li.call(this,t),Ui.call(this,e),Qi.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,r=n.calSelectedRangeByStart(t,e),l=r.sri,a=r.sci;if(i){var o=t,s=e;t<0&&(o=0),e<0&&(s=0),n.selector.setIndexes(o,s),this.indexes=[o,s]}this.moveIndexes=[l,a],this.range=r,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,r=this.lastri,l=this.lastci;if(i){if(t===r&&e===l)return;this.lastri=t,this.lastci=e}this.range=n.calSelectedRangeByEnd(t,e),$i.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,i=t.eci;this.setEnd(e,i)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var i=this.range,n=i.sri,r=i.sci,l=i.eri,a=i.eci,o=t,s=e,c=n-t,u=l-t,h=a-e;if(r-e>0)this.arange=new T(n,s,l,r-1);else if(c>0)this.arange=new T(o,r,n-1,a);else if(h<0)this.arange=new T(n,a+1,l,s);else{if(!(u<0))return void(this.arange=null);this.arange=new T(l+1,r,o,a)}if(null!==this.arange){var f=this.data.getRect(this.arange);f.width+=2,f.height+=2;var d=this.fourthQuadrant,v=this.thirdQuadrant,p=this.firstQuadrant,y=this.secondQuadrant;d.showAutofill(Mi.call(this,f)),v.showAutofill(ji.call(this,f)),p.showAutofill(Wi.call(this,f)),y.showAutofill(f)}}}},{key:"hideAutofill",value:function(){var t=this;["fourthQuadrant","thirdQuadrant","firstQuadrant","secondQuadrant"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();Ki.call(this,e),["fourthQuadrant","thirdQuadrant","firstQuadrant"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["fourthQuadrant","thirdQuadrant","firstQuadrant"].forEach((function(e){t[e].hideClipboard()}))}}]),t}();function Zi(t){return ct("div","".concat(h,"-item ").concat(t))}function Gi(t){var e=this;return Zi("state").child(j("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function tn(t){var e=this,i=this.filterbEl,n=this.filterValues;i.html(""),Object.keys(t).forEach((function(r,l){var a=t[r],o=n.includes(r)?"checked":"";i.child(ct("div","".concat(h,"-item state ").concat(o)).on("click.stop",(function(){return e.filterClick(l,r)})).children(""===r?j("filter.empty"):r,ct("div","label").html("(".concat(a,")"))))}))}function en(){var t=this.filterhEl,e=this.filterValues,i=this.values;t.html("".concat(e.length," / ").concat(i.length)),t.checked(e.length===i.length)}var nn=function(){function t(){var e=this;s(this,t),this.filterbEl=ct("div","".concat(h,"-body")),this.filterhEl=ct("div","".concat(h,"-header state")).on("click.stop",(function(){return e.filterClick(0,"all")})),this.el=ct("div","".concat(h,"-sort-filter")).children(this.sortAscEl=Gi.call(this,"asc"),this.sortDescEl=Gi.call(this,"desc"),Zi("divider"),ct("div","".concat(h,"-filter")).children(this.filterhEl,this.filterbEl),ct("div","".concat(h,"-buttons")).children(new je("cancel").on("click",(function(){return e.btnClick("cancel")})),new je("ok","primary").on("click",(function(){return e.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}return u(t,[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,i=this.sort,n=this.filterValues;this.ok&&this.ok(e,i,"in",n)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,i=this.sortDescEl;e.checked("asc"===t),i.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var i=this.filterbEl,n=this.filterValues,r=this.values,l=i.children();"all"===e?l.length===n.length?(this.filterValues=[],l.forEach((function(t){return ct(t).checked(!1)}))):(this.filterValues=Array.from(r),l.forEach((function(t){return ct(t).checked(!0)}))):ct(l[t]).toggle("checked")?n.push(e):n.splice(n.findIndex((function(t){return t===e})),1),en.call(this)}},{key:"set",value:function(t,e,i,n){this.ci=t;var r=this.sortAscEl,l=this.sortDescEl;null!==n?(this.sort=n.order,r.checked(n.asc()),l.checked(n.desc())):(this.sortDesc=null,r.checked(!1),l.checked(!1)),this.values=Object.keys(e),this.filterValues=i?Array.from(i.value):Object.keys(e),tn.call(this,e,i),en.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var i=1;yt(this.el,(function(){i<=0&&e.hide(),i-=1}))}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),pt(this.el)}}]),t}();function rn(t,e){var i=ct("div","".concat(h,"-toast")),n=ct("div","".concat(h,"-dimmer active"));i.children(ct("div","".concat(h,"-toast-header")).children(new Et("close").on("click.stop",(function(){return document.body.removeChild(i.el),void document.body.removeChild(n.el)})),t),ct("div","".concat(h,"-toast-content")).html(e)),document.body.appendChild(i.el),document.body.appendChild(n.el);var r=i.box(),l=r.width,a=r.height,o=document.documentElement,s=o.clientHeight,c=o.clientWidth;i.offset({left:(c-l)/2,top:(s-a)/3})}function ln(t,e){var i,n=this;return function(){for(var r=n,l=arguments.length,a=new Array(l),o=0;o<l;o++)a[o]=arguments[o];var s=a;i||(i=setTimeout((function(){i=null,t.apply(r,s)}),e))}}function an(){var t=this.data,e=this.verticalScrollbar,i=this.horizontalScrollbar,n=t.getSelectedRect(),r=n.l,l=n.t,a=n.left,o=n.top,s=n.width,c=n.height,u=this.getTableOffset();if(Math.abs(a)+s>u.width)i.move({left:r+s-u.width});else{var h=t.freezeTotalWidth();a<h&&i.move({left:r-1-h})}if(Math.abs(o)+c>u.height)e.move({top:l+c-u.height-1});else{var f=t.freezeTotalHeight();o<f&&e.move({top:l-1-f})}}function on(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==i){var l=this.table,a=this.selector,o=this.toolbar,s=this.data,c=this.contextmenu,u=s.getCell(e,i);t?(a.setEnd(e,i,r),this.trigger("cells-selected",u,a.range)):(a.set(e,i,n),this.trigger("cell-selected",u,e,i)),c.setMode(-1===e||-1===i?"row-col":"range"),o.reset(),l.render()}}function sn(t,e){var i=this.selector,n=this.data,r=n.rows,l=n.cols,o=a(i.indexes,2),s=o[0],c=o[1],u=i.range,h=u.eri,f=u.eci;if(t){var d=a(i.moveIndexes,2);s=d[0],c=d[1]}"left"===e?c>0&&(c-=1):"right"===e?(f!==c&&(c=f),c<l.len-1&&(c+=1)):"up"===e?s>0&&(s-=1):"down"===e?(h!==s&&(s=h),s<r.len-1&&(s+=1)):"row-first"===e?c=0:"row-last"===e?c=l.len-1:"col-first"===e?s=0:"col-last"===e&&(s=r.len-1),t&&(i.moveIndexes=[s,c]),on.call(this,t,s,c),an.call(this)}function cn(t){if(0===t.buttons&&t.target.className!=="".concat(h,"-resizer-hover")){var e=t.offsetX,i=t.offsetY,n=this.rowResizer,r=this.colResizer,l=this.tableEl,a=this.data,o=a.rows,s=a.cols;if(e>s.indexWidth&&i>o.height)return n.hide(),void r.hide();var c=l.box(),u=a.getCellRectByXY(t.offsetX,t.offsetY);u.ri>=0&&-1===u.ci?(u.width=s.indexWidth,n.show(u,{width:c.width}),o.isHide(u.ri-1)?n.showUnhide(u.ri):n.hideUnhide()):n.hide(),-1===u.ri&&u.ci>=0?(u.height=o.height,r.show(u,{height:c.height}),s.isHide(u.ci-1)?r.showUnhide(u.ci):r.hideUnhide()):r.hide()}}function un(t){var e=this.verticalScrollbar,i=this.horizontalScrollbar,n=this.data,r=e.scroll().top,l=i.scroll().left,a=n.rows,o=n.cols,s=t.deltaY,c=t.deltaX,u=function(t,e){var i=t,n=0;do{n=e(i),i+=1}while(n<=0);return n},h=function(t){if(t>0){var i=n.scroll.ri+1;if(i<a.len){var l=u(i,(function(t){return a.getHeight(t)}));e.move({top:r+l-1})}}else{var o=n.scroll.ri-1;if(o>=0){var s=u(o,(function(t){return a.getHeight(t)}));e.move({top:0===o?0:r-s})}}},f=Math.abs(s),d=Math.abs(c),v=Math.max(f,d);/Firefox/i.test(window.navigator.userAgent)&&ln(h(t.detail),50),v===d&&ln(function(t){if(t>0){var e=n.scroll.ci+1;if(e<o.len){var r=u(e,(function(t){return o.getWidth(t)}));i.move({left:l+r-1})}}else{var a=n.scroll.ci-1;if(a>=0){var s=u(a,(function(t){return o.getWidth(t)}));i.move({left:0===a?0:l-s})}}}(c),50),v===f&&ln(h(s),50)}function hn(t,e){var i=this.verticalScrollbar,n=this.horizontalScrollbar,r=i.scroll().top,l=n.scroll().left;"left"===t||"right"===t?n.move({left:l-e}):"up"!==t&&"down"!==t||i.move({top:r-e})}function fn(){var t=this.data,e=this.verticalScrollbar,i=this.getTableOffset().height,n=t.exceptRowTotalHeight(0,-1);e.set(i,t.rows.totalHeight()-n)}function dn(){var t=this.data,e=this.horizontalScrollbar,i=this.getTableOffset().width;t&&e.set(i,t.cols.totalWidth())}function vn(){var t=this.selector,e=this.data,i=this.editor,n=a(e.freeze,2),r=n[0],l=n[1];if(r>0||l>0){var o=e.freezeTotalWidth(),s=e.freezeTotalHeight();i.setFreezeLengths(o,s)}t.resetAreaOffset()}function pn(){var t=this.tableEl,e=this.overlayerEl,i=this.overlayerContentEl,n=this.table,r=this.toolbar,l=this.selector,a=this.el,o=this.getTableOffset(),s=this.getRect();t.attr(s),e.offset(s),i.offset(o),a.css("width","".concat(s.width,"px")),fn.call(this),dn.call(this),vn.call(this),n.render(),r.reset(),l.reset()}function yn(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function gn(t){var e=this.data,i=this.selector;"read"!==e.settings.mode&&(e.copy(),e.copyToSystemClipboard(t),i.showClipboard())}function mn(){var t=this.data,e=this.selector;"read"!==t.settings.mode&&(t.cut(),e.showClipboard())}function wn(t,e){var i=this.data;if("read"!==i.settings.mode)if(i.paste(t,(function(t){return rn("Tip",t)})))pn.call(this);else if(e){var n=e.clipboardData.getData("text/plain");this.data.pasteFromText(n),pn.call(this)}}function kn(){this.data.hideRowsOrCols(),pn.call(this)}function bn(t,e){this.data.unhideRowsOrCols(t,e),pn.call(this)}function xn(){this.data.autofilter(),pn.call(this)}function Rn(){var t=this.toolbar;t.paintFormatActive()&&(wn.call(this,"format"),yn.call(this),t.paintFormatToggle())}function Cn(t){var e=this,i=this.selector,n=this.data,r=this.table,l=this.sortFilter,a=t.offsetX,o=t.offsetY,s=t.target.className==="".concat(h,"-selector-corner"),c=n.getCellRectByXY(a,o),u=c.left,f=c.top,d=c.width,v=c.height,p=c.ri,y=c.ci,g=n.autoFilter;if(g.includes(p,y)&&u+d-20<a&&f+v-20<o){var m=g.items(y,(function(t,e){return n.rows.getCell(t,e)}));return l.hide(),l.set(y,m,g.getFilter(y),g.getSort(y)),void l.setOffset({left:u,top:f+v+2})}t.shiftKey||(s?i.showAutofill(p,y):on.call(this,!1,p,y),gt(window,(function(t){var r=n.getCellRectByXY(t.offsetX,t.offsetY);p=r.ri,y=r.ci,s?i.showAutofill(p,y):1!==t.buttons||t.shiftKey||on.call(e,!0,p,y,!0,!0)}),(function(){s&&i.arange&&"read"!==n.settings.mode&&n.autofill(i.arange,"all",(function(t){return rn("Tip",t)}))&&r.render(),i.hideAutofill(),Rn.call(e)}))),s||1!==t.buttons||t.shiftKey&&on.call(this,!0,p,y)}function En(){var t=this.editor,e=this.data.getSelectedRect(),i=this.getTableOffset(),n="top";e.top>i.height/2&&(n="bottom"),t.setOffset(e,n)}function Sn(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(En.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),yn.call(this))}function On(t){var e=this,i=this.data,n=this.table,r=this.selector;i.scrolly(t,(function(){r.resetBRLAreaOffset(),En.call(e),n.render()}))}function Dn(t){var e=this,i=this.data,n=this.table,r=this.selector;i.scrollx(t,(function(){r.resetBRTAreaOffset(),En.call(e),n.render()}))}function Tn(t,e){var i=t.ri,n=this.table,r=this.selector;this.data.rows.setHeight(i,e),n.render(),r.resetAreaOffset(),fn.call(this),En.call(this)}function An(t,e){var i=t.ci,n=this.table,r=this.selector;this.data.cols.setWidth(i,e),n.render(),r.resetAreaOffset(),dn.call(this),En.call(this)}function zn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",i=this.data,n=this.table;if("read"!==i.settings.mode){i.setSelectedCellText(t,e);var r=i.selector,l=r.ri,a=r.ci;"finished"===e?n.render():this.trigger("cell-edited",t,l,a)}}function Bn(t){var e=this.data;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),yn.call(this),pn.call(this))}function In(t,e){var i=this.data;switch(t){case"undo":this.undo();break;case"redo":this.redo();break;case"print":this.print.preview();break;case"paintformat":!0===e?gn.call(this):yn.call(this);break;case"clearformat":Bn.call(this,"delete-cell-format");break;case"link":case"chart":break;case"autofilter":xn.call(this);break;case"freeze":if(e){var n=i.selector,r=n.ri,l=n.ci;this.freeze(r,l)}else this.freeze(0,0);break;default:i.setSelectedCellAttr(t,e),"formula"!==t||i.selector.multiple()||Sn.call(this),pn.call(this)}}function Pn(t,e,i,n){this.data.setAutoFilter(t,e,i,n),pn.call(this)}function Hn(){var t,e,i,n,r,l,a=this,o=this.selector,s=this.overlayerEl,c=this.rowResizer,u=this.colResizer,h=this.verticalScrollbar,f=this.horizontalScrollbar,d=this.editor,v=this.contextmenu,p=this.toolbar,y=this.sortFilter;s.on("mousemove",(function(t){cn.call(a,t)})).on("mousedown",(function(t){d.clear(),v.hide(),2===t.buttons?(a.data.xyInSelectedRect(t.offsetX,t.offsetY)||Cn.call(a,t),v.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):2===t.detail?Sn.call(a):Cn.call(a,t)})).on("mousewheel.stop",(function(t){un.call(a,t)})).on("mouseout",(function(t){var e=t.offsetX;t.offsetY<=0&&u.hide(),e<=0&&c.hide()})),o.inputChange=function(t){zn.call(a,t,"input"),Sn.call(a)},t=s.el,i=(e={move:function(t,e){hn.call(a,t,e)}}).move,n=e.end,r=0,l=0,dt(t,"touchstart",(function(t){var e=t.touches[0],i=e.pageX,n=e.pageY;r=i,l=n})),dt(t,"touchmove",(function(t){if(i){var e=t.changedTouches[0],n=e.pageX,a=e.pageY,o=n-r,s=a-l;(Math.abs(o)>10||Math.abs(s)>10)&&(mt(o,s,t,i),r=n,l=a),t.preventDefault()}})),dt(t,"touchend",(function(t){if(n){var e=t.changedTouches[0],i=e.pageX,a=e.pageY;mt(i-r,a-l,t,n)}})),p.change=function(t,e){return In.call(a,t,e)},y.ok=function(t,e,i,n){return Pn.call(a,t,e,i,n)},c.finishedFn=function(t,e){Tn.call(a,t,e)},u.finishedFn=function(t,e){An.call(a,t,e)},c.unhideFn=function(t){bn.call(a,"row",t)},u.unhideFn=function(t){bn.call(a,"col",t)},h.moveFn=function(t,e){On.call(a,t,e)},f.moveFn=function(t,e){Dn.call(a,t,e)},d.change=function(t,e){zn.call(a,e,t)},v.itemClick=function(t){"validation"===t||("copy"===t?gn.call(a):"cut"===t?mn.call(a):"paste"===t?wn.call(a,"all"):"paste-value"===t?wn.call(a,"text"):"paste-format"===t?wn.call(a,"format"):"hide"===t?kn.call(a):Bn.call(a,t))},dt(window,"resize",(function(){a.reload()})),dt(window,"click",(function(t){a.focusing=s.contains(t.target)})),dt(window,"paste",(function(t){a.focusing&&(wn.call(a,"all",t),t.preventDefault())})),dt(window,"copy",(function(t){a.focusing&&(gn.call(a,t),t.preventDefault())})),dt(window,"keydown",(function(t){if(a.focusing){var e=t.keyCode||t.which,i=t.key,n=t.ctrlKey,r=t.shiftKey,l=t.metaKey;if(n||l)switch(e){case 90:a.undo(),t.preventDefault();break;case 89:a.redo(),t.preventDefault();break;case 67:case 86:default:break;case 88:mn.call(a),t.preventDefault();break;case 85:p.trigger("underline"),t.preventDefault();break;case 37:sn.call(a,r,"row-first"),t.preventDefault();break;case 38:sn.call(a,r,"col-first"),t.preventDefault();break;case 39:sn.call(a,r,"row-last"),t.preventDefault();break;case 40:sn.call(a,r,"col-last"),t.preventDefault();break;case 32:on.call(a,!1,-1,a.data.selector.ci,!1),t.preventDefault();break;case 66:p.trigger("bold");break;case 73:p.trigger("italic")}else{switch(e){case 32:r&&on.call(a,!1,a.data.selector.ri,-1,!1);break;case 27:v.hide(),yn.call(a);break;case 37:sn.call(a,r,"left"),t.preventDefault();break;case 38:sn.call(a,r,"up"),t.preventDefault();break;case 39:sn.call(a,r,"right"),t.preventDefault();break;case 40:sn.call(a,r,"down"),t.preventDefault();break;case 9:d.clear(),sn.call(a,!1,r?"left":"right"),t.preventDefault();break;case 13:d.clear(),sn.call(a,!1,r?"up":"down"),t.preventDefault();break;case 8:Bn.call(a,"delete-cell-text"),t.preventDefault()}"Delete"===i?(Bn.call(a,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(zn.call(a,t.key,"input"),Sn.call(a)):113===e&&Sn.call(a)}}}))}var Fn=function(){function t(e,i){var n=this;s(this,t),this.eventMap=function(){var t=new Map;function e(e,i){var n;return t.has(e)&&(n=t.get(e),Array.isArray(n)&&n.push(i)||!1)||t.set(e,[].concat(i))}function i(e,i){var n,r;return t.has(e)&&(r=(n=t.get(e)).indexOf(i))>=0&&n.splice(r,1)&&0===t.get(e).length&&t.delete(e)}return{get current(){return t},on:e,once:function(t,n){return e(t,(function e(){for(var r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];n.call.apply(n,[null].concat(l)),i(t,e)}))},fire:function(e,i){return t.has(e)&&function(){var n,r=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return ft(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ft(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,o=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){o=!0,l=t},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw l}}}}(t.get(e));try{for(r.s();!(n=r.n()).done;){var l=n.value;l.call.apply(l,[null].concat(d(i)))}}catch(t){r.e(t)}finally{r.f()}}()},removeListener:i,removeAllListeners:function(){t.clear()}}}();var r=i.settings,l=r.view,a=r.showToolbar,o=r.showContextmenu;this.el=ct("div","".concat(h,"-sheet")),this.toolbar=new Be(i,l.width,!a),this.print=new hi(i),e.children(this.toolbar.el,this.el,this.print.el),this.data=i,this.tableEl=ct("canvas","".concat(h,"-table")),this.rowResizer=new fi(!1,i.rows.height),this.colResizer=new fi(!0,i.cols.minWidth),this.verticalScrollbar=new di(!0),this.horizontalScrollbar=new di(!1),this.editor=new zi(ut,(function(){return n.getTableOffset()}),i.rows.height),this.modalValidation=null,this.contextmenu=new Hi((function(){return n.getRect()}),!o),this.selector=new Ji(i),this.overlayerContentEl=ct("div","".concat(h,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=ct("div","".concat(h,"-overlayer")).child(this.overlayerContentEl),this.sortFilter=new nn,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextmenu.el,this.sortFilter.el),this.table=new ri(this.tableEl.el,i),Hn.call(this),pn.call(this),on.call(this,!1,0,0)}return u(t,[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];e.fire(t,n)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,fn.call(this),dn.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),pn.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),pn.call(this),this}},{key:"undo",value:function(){this.data.undo(),pn.call(this)}},{key:"redo",value:function(){this.data.redo(),pn.call(this)}},{key:"reload",value:function(){return pn.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,i=t.cols,n=this.getRect(),r=n.width,l=n.height;return{width:r-i.indexWidth,height:l-e.height,left:i.indexWidth,top:e.height}}}]),t}(),Nn=function(){function t(e,i){var n=this;s(this,t),this.vchange=function(){},this.el=ct("div","".concat(h,"-form-input")),this.input=ct("input","").css("width",e).on("input",(function(t){return n.vchange(t)})).attr("placeholder",i),this.el.child(this.input)}return u(t,[{key:"focus",value:function(){var t=this;setTimeout((function(){t.input.el.focus()}),10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}]),t}();var Mn=function(t){bt(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Ct(e);if(i){var r=Ct(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Rt(this,t)});function r(t){var e;s(this,r);var i=new Et("ellipsis");return(e=n.call(this,i,"auto",!1,"top-left")).contentClick=t,e}return u(r,[{key:"reset",value:function(t){var e=this,i=t.map((function(t,i){return ct("div","".concat(h,"-item")).css("width","150px").css("font-weight","normal").on("click",(function(){e.contentClick(i),e.hide()})).child(t)}));this.setContentChildren.apply(this,d(i))}}]),r}(St),Wn=[{key:"delete",title:_("contextmenu.deleteSheet")}];function jn(t){var e=this;return ct("div","".concat(h,"-item")).child(t.title()).on("click",(function(){e.itemClick(t.key),e.hide()}))}function _n(){var t=this;return Wn.map((function(e){return jn.call(t,e)}))}var Vn=function(){function t(){var e;s(this,t),this.el=(e=ct("div","".concat(h,"-contextmenu")).css("width","160px")).children.apply(e,d(_n.call(this))).hide(),this.itemClick=function(){}}return u(t,[{key:"hide",value:function(){var t=this.el;t.hide(),pt(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),yt(e)}}]),t}();const qn=Vn;var Ln=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};s(this,t),this.swapFunc=n,this.updateFunc=l,this.items=[],this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.moreEl=new Mn((function(t){e.clickSwap2(e.items[t])})),this.contextmenu=new qn,this.contextmenu.itemClick=r,this.el=ct("div","".concat(h,"-bottombar")).children(this.contextmenu.el,this.menuEl=ct("ul","".concat(h,"-menu")).child(ct("li","").children(new Et("add").on("click",(function(){i()})),ct("span","").child(this.moreEl))))}return u(t,[{key:"addItem",value:function(t,e,i){var n=this;this.dataNames.push(t);var r=ct("li",e?"active":"").child(t);r.on("click",(function(){n.clickSwap2(r)})).on("contextmenu",(function(t){if("read"!==i.mode){var e=t.target,l=e.offsetLeft,a=e.offsetHeight;n.contextmenu.setOffset({left:l,bottom:a+1}),n.deleteEl=r}})).on("dblclick",(function(){if("read"!==i.mode){var t=r.html(),e=new Nn("auto","");e.val(t),e.input.on("blur",(function(e){var i=e.target.value,r=n.dataNames.findIndex((function(e){return e===t}));n.renameItem(r,i)})),r.html("").child(e.el),e.focus()}})),e&&this.clickSwap(r),this.items.push(r),this.menuEl.child(r),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach((function(e){t.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var i=this.items.findIndex((function(t){return t===e}));if(this.items.splice(i,1),this.dataNames.splice(i,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var n=a(this.items,1)[0];return this.activeEl=n,this.activeEl.toggle(),[i,0]}return[i,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex((function(e){return e===t}));this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}]),t}();const Qn=Ln;function Un(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Yn(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Un(Object(i),!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Un(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Xn=function(){function t(e){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,t);var r=e;this.options=Yn({showBottomBar:!0},n),this.sheetIndex=1,this.datas=[],"string"==typeof e&&(r=document.querySelector(e)),this.bottomBar=this.options.showBottomBar?new Qn((function(){if("read"!==i.options.mode){var t=i.addSheet();i.sheet.resetData(t)}}),(function(t){var e=i.datas[t];i.sheet.resetData(e)}),(function(){i.deleteSheet()}),(function(t,e){i.datas[t].name=e,i.sheet.trigger("change")})):null,this.data=this.addSheet(void 0);var l=ct("div","".concat(h)).on("contextmenu",(function(t){return t.preventDefault()}));r.appendChild(l.el),this.sheet=new Fn(l,this.data),null!==this.bottomBar&&l.child(this.bottomBar.el)}return u(t,[{key:"addSheet",value:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t||"sheet".concat(this.sheetIndex),r=new at(n,this.options);return r.change=function(){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];(t=e.sheet).trigger.apply(t,["change"].concat(n))},this.datas.push(r),null!==this.bottomBar&&this.bottomBar.addItem(n,i,this.options),this.sheetIndex+=1,r}},{key:"deleteSheet",value:function(){if(null!==this.bottomBar){var t=a(this.bottomBar.deleteItem(),2),e=t[0],i=t[1];e>=0&&(this.datas.splice(e,1),i>=0&&this.sheet.trigger("change"))}}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottomBar&&this.bottomBar.clear(),this.datas=[],e.length>0)for(var i=0;i<e.length;i+=1){var n=e[i],r=this.addSheet(n.name,0===i);r.setData(n),0===i&&this.sheet.resetData(r)}return this}},{key:"getData",value:function(){return this.datas.map((function(t){return t.getData()}))}},{key:"cellText",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[n].setCellText(t,e,i,"finished"),this}},{key:"cell",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[i].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[i].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}],[{key:"locale",value:function(t,e){!function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?N=[t]:N.unshift(t),e&&(M[t]=e)}(t,e)}}]),t}();const $n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Xn(t,e)};return e.default})()}));